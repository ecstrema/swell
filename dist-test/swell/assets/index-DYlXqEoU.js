const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/menu-CflLqbJl.js","assets/core-oPxbWvCg.js","assets/dpi-CaP9ef2h.js","assets/window-D7BWqsld.js","assets/backend-DthrPGwh.js","assets/backend-BgGI_OVN.js"])))=>i.map(i=>d[i]);
import{a as e,c as t,i as n,l as r,n as i,r as a,s as o,t as s}from"./backend-BgGI_OVN.js";import{i as c}from"./core-oPxbWvCg.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var l=`app-theme`;const u=class e{static instance;currentTheme=`auto`;constructor(){this.loadTheme(),this.applyTheme()}static getInstance(){return e.instance||=new e,e.instance}loadTheme(){let e=localStorage.getItem(l);e&&[`light`,`dark`,`auto`,`system`].includes(e)&&(this.currentTheme=e)}saveTheme(){localStorage.setItem(l,this.currentTheme)}applyTheme(){let e=document.documentElement;e.classList.remove(`theme-light`,`theme-dark`),this.currentTheme===`light`?e.classList.add(`theme-light`):this.currentTheme===`dark`&&e.classList.add(`theme-dark`)}setTheme(e){this.currentTheme=e,this.saveTheme(),this.applyTheme()}getTheme(){return this.currentTheme}toggleTheme(){this.currentTheme===`auto`?this.setTheme(`light`):this.currentTheme===`light`?this.setTheme(`dark`):this.setTheme(`auto`)}}.getInstance();var ee=`modulepreload`,d=function(e){return`/swell/`+e},te={};const f=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),i=document.querySelector(`meta[property=csp-nonce]`),a=i?.nonce||i?.getAttribute(`nonce`);function o(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}r=o(t.map(t=>{if(t=d(t,n),t in te)return;te[t]=!0;let r=t.endsWith(`.css`),i=r?`[rel="stylesheet"]`:``;if(n)for(let n=e.length-1;n>=0;n--){let i=e[n];if(i.href===t&&(!r||i.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;let o=document.createElement(`link`);if(o.rel=r?`stylesheet`:ee,r||(o.as=`script`),o.crossOrigin=``,o.href=t,a&&o.setAttribute(`nonce`,a),document.head.appendChild(o),r)return new Promise((e,n)=>{o.addEventListener(`load`,e),o.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function i(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(let e of t||[])e.status===`rejected`&&i(e.reason);return e().catch(i)})};async function ne(t){if(e){let{MenuItem:e}=await f(async()=>{let{MenuItem:e}=await import(`./menu-CflLqbJl.js`);return{MenuItem:e}},__vite__mapDeps([0,1,2]));return t.type===`separator`?{type:`separator`}:(await e.new({id:t.id,text:t.text,action:t.action}),{id:t.id,text:t.text,type:`normal`})}else return{id:t.id,text:t.text,type:t.type||`normal`}}async function p(t){if(e){let{Submenu:e,MenuItem:n,PredefinedMenuItem:r}=await f(async()=>{let{Submenu:e,MenuItem:t,PredefinedMenuItem:n}=await import(`./menu-CflLqbJl.js`);return{Submenu:e,MenuItem:t,PredefinedMenuItem:n}},__vite__mapDeps([0,1,2])),i=[];for(let a of t.items)if(`items`in a){await p(a);let t=await e.new({text:a.text,items:[]});i.push(t)}else{let e=a;e.type===`separator`?i.push(await r.new({item:`Separator`})):i.push(await n.new({id:e.id,text:e.text,action:e.action}))}await e.new({text:t.text,items:i});let a=[];for(let e of t.items)`items`in e?a.push(await p(e)):a.push(await ne(e));return{text:t.text,items:a}}else{let e=[];for(let n of t.items)`items`in n?e.push(await p(n)):e.push(await ne(n));return{text:t.text,items:e}}}async function re(t){if(e){let{Menu:e,Submenu:n,MenuItem:r,PredefinedMenuItem:i}=await f(async()=>{let{Menu:e,Submenu:t,MenuItem:n,PredefinedMenuItem:r}=await import(`./menu-CflLqbJl.js`);return{Menu:e,Submenu:t,MenuItem:n,PredefinedMenuItem:r}},__vite__mapDeps([0,1,2])),a=[];for(let e of t.items){let t=[];for(let a of e.items)if(`items`in a){let e=a,o=[];for(let t of e.items)if(`items`in t)console.warn(`Deep nesting not fully supported yet`);else{let e=t;e.type===`separator`?o.push(await i.new({item:`Separator`})):o.push(await r.new({id:e.id,text:e.text,action:e.action}))}t.push(await n.new({text:e.text,items:o}))}else{let e=a;e.type===`separator`?t.push(await i.new({item:`Separator`})):t.push(await r.new({id:e.id,text:e.text,action:e.action}))}a.push(await n.new({text:e.text,items:t}))}await(await e.new({items:a})).setAsAppMenu();let o=[];for(let e of t.items)o.push(await p(e));return{items:o}}else{let e=[];for(let n of t.items)e.push(await p(n));return{items:e}}}function m(e){let t=new CSSStyleSheet;return t.replaceSync(e),t}var ie=`:host{background:var(--menu-bg);border-bottom:1px solid var(--menu-border);user-select:none;color:var(--color-text);font-family:sans-serif;font-size:14px;display:block}.menu-bar{display:flex}.menu-group{position:relative}.menu-title{cursor:pointer;padding:5px 10px}.menu-title:hover{background:var(--menu-item-hover)}.dropdown{background:var(--menu-dropdown-bg);border:1px solid var(--menu-border);box-shadow:2px 2px 5px var(--menu-shadow);z-index:1000;min-width:150px;display:none;position:absolute;top:100%;left:0}.menu-group:hover .dropdown{display:block}.menu-item{cursor:pointer;padding:8px 15px}.menu-item:hover{background:var(--menu-item-hover)}.separator{background:var(--menu-border);height:1px;margin:4px 0}.menu-submenu{position:relative}.submenu-title{cursor:pointer;justify-content:space-between;align-items:center;padding:8px 15px;display:flex}.submenu-title:hover{background:var(--menu-item-hover)}.submenu-arrow{margin-left:10px;font-size:10px}.submenu-dropdown{background:var(--menu-dropdown-bg);border:1px solid var(--menu-border);box-shadow:2px 2px 5px var(--menu-shadow);z-index:1001;min-width:150px;display:none;position:absolute;top:0;left:100%}.menu-submenu:hover>.submenu-dropdown{display:block}`;function ae(e,t={}){let n=[];return e.forEach(e=>{if(`items`in e){let r=e,i=document.createElement(`div`);i.className=`menu-submenu`;let a=document.createElement(`div`);a.className=`submenu-title`,a.textContent=r.text;let o=document.createElement(`span`);o.className=`submenu-arrow`,o.textContent=`▶`,a.appendChild(o);let s=document.createElement(`div`);s.className=`submenu-dropdown`,ae(r.items,{...t,isSubmenu:!0}).forEach(({element:e})=>{s.appendChild(e)}),i.appendChild(a),i.appendChild(s),n.push({element:i})}else if(e.type===`separator`){let e=document.createElement(`div`);e.className=t.isSubmenu?`menu-separator`:`separator`,n.push({element:e})}else{let t=e,r=document.createElement(`div`);r.className=`menu-item`,r.textContent=t.text??``,t.id&&(r.dataset.id=t.id),n.push({element:r,id:t.id,action:t.action})}}),n}function oe(e,t){for(let n of t)if(`items`in n){if(oe(e,n.items))return!0}else{let t=n;if(t.id===e&&t.action)return t.action(),!0}return!1}var se=class extends HTMLElement{menuConfig=null;constructor(){super(),this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[m(ie)]}async connectedCallback(){await this.initMenu(),e?this.style.display=`none`:this.render()}async initMenu(){try{let t=[{id:`open`,text:`Open File...`,action:()=>{this.dispatchEvent(new CustomEvent(`file-open-request`,{bubbles:!0,composed:!0}))}},{text:`Open Example`,items:[{id:`open-example-simple-vcd`,text:`simple.vcd`,action:()=>{this.dispatchEvent(new CustomEvent(`open-example-request`,{bubbles:!0,composed:!0,detail:`simple.vcd`}))}},{id:`open-example-simple-ghw`,text:`simple.ghw`,action:()=>{this.dispatchEvent(new CustomEvent(`open-example-request`,{bubbles:!0,composed:!0,detail:`simple.ghw`}))}},{id:`open-example-counter-vcd`,text:`counter.vcd`,action:()=>{this.dispatchEvent(new CustomEvent(`open-example-request`,{bubbles:!0,composed:!0,detail:`counter.vcd`}))}},{id:`open-example-example-fst`,text:`example.fst`,action:()=>{this.dispatchEvent(new CustomEvent(`open-example-request`,{bubbles:!0,composed:!0,detail:`example.fst`}))}},{id:`open-example-time-test-ghw`,text:`time_test.ghw`,action:()=>{this.dispatchEvent(new CustomEvent(`open-example-request`,{bubbles:!0,composed:!0,detail:`time_test.ghw`}))}}]},{type:`separator`},{id:`settings`,text:`Settings...`,action:()=>{this.dispatchEvent(new CustomEvent(`settings-open-request`,{bubbles:!0,composed:!0}))}}];e&&t.push({type:`separator`},{id:`quit`,text:`Quit`,action:async()=>{let{getCurrentWindow:e}=await f(async()=>{let{getCurrentWindow:e}=await import(`./window-D7BWqsld.js`);return{getCurrentWindow:e}},__vite__mapDeps([3,1,2]));await e().close()}}),this.menuConfig={items:[{text:`File`,items:t},{text:`Edit`,items:[{id:`undo`,text:`Undo`,action:()=>{this.dispatchEvent(new CustomEvent(`menu-action`,{bubbles:!0,composed:!0,detail:`edit-undo`}))}}]},{text:`View`,items:[{text:`Theme`,items:[{id:`theme-light`,text:`Light`,action:()=>{u.setTheme(`light`)}},{id:`theme-dark`,text:`Dark`,action:()=>{u.setTheme(`dark`)}},{id:`theme-auto`,text:`Auto`,action:()=>{u.setTheme(`auto`)}}]}]},{text:`Help`,items:[{id:`about`,text:`About`,action:()=>{this.dispatchEvent(new CustomEvent(`about-open-request`,{bubbles:!0,composed:!0}))}}]}]},await re(this.menuConfig)}catch(e){console.error(`Failed to init menu`,e)}}render(){if(this.shadowRoot&&this.menuConfig){let e=document.createElement(`div`);e.className=`menu-bar`,this.menuConfig.items.forEach(t=>{let n=document.createElement(`div`);n.className=`menu-group`;let r=document.createElement(`div`);r.className=`menu-title`,r.textContent=t.text;let i=document.createElement(`div`);i.className=`dropdown`,ae(t.items).forEach(({element:e})=>{i.appendChild(e)}),n.appendChild(r),n.appendChild(i),e.appendChild(n)}),this.shadowRoot.innerHTML=``,this.shadowRoot.appendChild(e),this.shadowRoot.querySelectorAll(`.menu-item`).forEach(e=>{e.addEventListener(`click`,e=>{let t=e.target.dataset.id;if(t&&this.menuConfig){for(let e of this.menuConfig.items)if(oe(t,e.items))break}})})}}};customElements.define(`app-menu-bar`,se);const ce=m(`:host{scrollbar-width:thin;scrollbar-color:var(--scrollbar-thumb) var(--scrollbar-track)}::-webkit-scrollbar{width:10px;height:10px}::-webkit-scrollbar-track{background:var(--scrollbar-track)}::-webkit-scrollbar-thumb{background:var(--scrollbar-thumb);border:2px solid var(--scrollbar-track);border-radius:5px}::-webkit-scrollbar-thumb:hover{background:var(--scrollbar-thumb-hover)}`);var le=`:host{background-color:var(--color-bg-surface);height:100%;color:var(--color-text);font-family:monospace;font-size:14px;display:block;overflow-y:auto}details{padding-left:var(--tree-indent,20px)}details>summary{cursor:pointer;margin-left:calc(-1 * var(--tree-indent,20px));user-select:none;padding:2px 4px;list-style:none}details>summary::-webkit-details-marker{display:none}details>summary:hover{background-color:var(--color-bg-hover)}details>summary:before{content:"▶";margin-right:6px;font-size:.8em;transition:transform .2s;display:inline-block}details[open]>summary:before{transform:rotate(90deg)}.leaf-node{cursor:pointer;color:var(--color-text-muted);align-items:center;gap:6px;padding:2px 4px;display:flex}.leaf-node:hover{background-color:var(--color-bg-hover);color:var(--color-text)}.leaf-checkbox{cursor:pointer;flex-shrink:0;margin:0}.leaf-checkbox:disabled{cursor:not-allowed}.empty-msg{text-align:center;color:var(--color-text-muted);font-family:var(--font-family,sans-serif);padding:20px;font-style:italic}`;const h=new class{settings=new Map;register(e){this.settings.set(e.path,e)}get(e){return this.settings.get(e)}getAll(){return Array.from(this.settings.values())}has(e){return this.settings.has(e)}getGrouped(){let e=new Map;for(let t of this.settings.values()){let n=t.path.split(`/`)[0];e.has(n)||e.set(n,[]),e.get(n).push(t)}return e}};h.register({path:`Application/Color Theme`,description:`Choose the color theme for the application`,type:`enum`,defaultValue:`system`,enumOptions:[`light`,`dark`,`system`],options:[{value:`light`,label:`Light`},{value:`dark`,label:`Dark`},{value:`system`,label:`System`}]}),h.register({path:`Interface/Tree Indent`,description:`Indentation in pixels for tree hierarchy levels`,type:`number`,defaultValue:20,min:0,max:60,step:1});var ue=`settings.json`;async function de(t){if(e)try{return await c(`get_setting`,{path:t})}catch(e){return console.error(`Failed to get setting ${t}:`,e),h.get(t)?.defaultValue}else{try{let e=localStorage.getItem(ue);if(e)return pe(JSON.parse(e),t)}catch(e){console.error(`Failed to get setting ${t}:`,e)}return h.get(t)?.defaultValue}}async function fe(t,n){if(e)try{await c(`set_setting`,{path:t,value:JSON.stringify(n)})}catch(e){throw console.error(`Failed to set setting ${t}:`,e),e}else try{let e=localStorage.getItem(ue),r=e?JSON.parse(e):{};me(r,t,n),localStorage.setItem(ue,JSON.stringify(r,null,2))}catch(e){throw console.error(`Failed to set setting ${t}:`,e),e}}function pe(e,t){let n=t.split(`/`),r=e;for(let e of n)if(r&&typeof r==`object`&&e in r)r=r[e];else return;return r}function me(e,t,n){let r=t.split(`/`),i=e;for(let e=0;e<r.length-1;e++){let t=r[e];(!(t in i)||typeof i[t]!=`object`)&&(i[t]={}),i=i[t]}i[r[r.length-1]]=n}var he=class e extends HTMLElement{static INDENT_SETTING_PATH=`Interface/Tree Indent`;_data=[];_config={};container;indentLoadPromise=null;boundSettingChangeHandler;constructor(){super(),this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[ce,m(le)],this.shadowRoot.innerHTML=`
        <div id="tree-container"></div>
        `,this.container=this.shadowRoot.querySelector(`#tree-container`),this.boundSettingChangeHandler=t=>{let{path:n,value:r}=t.detail;n===e.INDENT_SETTING_PATH&&this.updateIndent(r)}}connectedCallback(){this.addEventListener(`setting-changed`,this.boundSettingChangeHandler),this.indentLoadPromise||=this.loadIndentSetting()}disconnectedCallback(){this.removeEventListener(`setting-changed`,this.boundSettingChangeHandler),this.indentLoadPromise=null}async loadIndentSetting(){try{let t=await de(e.INDENT_SETTING_PATH);t!==void 0&&this.updateIndent(t)}catch{}}updateIndent(e){this.style.setProperty(`--tree-indent`,`${e}px`)}set data(e){this._data=e,this.render()}get data(){return this._data}set config(e){this._config=e,this.render()}get config(){return this._config}render(){if(this.container.innerHTML=``,!this._data||this._data.length===0){this.container.innerHTML=`<div class="empty-msg">No items</div>`;return}this._data.forEach(e=>{this.container.appendChild(this.createNodeElement(e))})}createNodeElement(e){return(this._config.hasChildren?this._config.hasChildren(e):e.children&&e.children.length>0)?this.createBranchElement(e):this.createLeafElement(e)}createBranchElement(e){let t=document.createElement(`details`);t.className=this._config.scopeNodeClass||`tree-node`,t.open=!0;let n=document.createElement(`summary`);return n.textContent=e.name,t.appendChild(n),e.children&&e.children.forEach(e=>{t.appendChild(this.createNodeElement(e))}),t}createLeafElement(e){let t=document.createElement(`div`);if(t.className=this._config.leafNodeClass||`leaf-node`,t.dataset.id=String(e.id),this._config.showCheckboxes){let n=document.createElement(`input`);n.type=`checkbox`,n.className=`leaf-checkbox`,n.checked=this._config.isChecked?this._config.isChecked(e):!1,n.addEventListener(`click`,e=>{e.stopPropagation()}),t.appendChild(n)}let n=document.createElement(`span`);return n.textContent=e.name,t.appendChild(n),this._config.onLeafClick&&t.addEventListener(`click`,()=>{this._config.onLeafClick(e)}),t}};customElements.get(`tree-view`)||customElements.define(`tree-view`,he);var ge=`:host{border-right:1px solid var(--color-border)}`,_e=class extends he{_hierarchyData=null;_filename=null;_selectedSignalRefs=new Set;constructor(){if(super(),this.shadowRoot){let e=Array.from(this.shadowRoot.adoptedStyleSheets);this.shadowRoot.adoptedStyleSheets=[...e,m(ge)]}this.updateConfig()}updateConfig(){this.config={onLeafClick:e=>{this.dispatchEvent(new CustomEvent(`signal-select`,{detail:{name:e.name,ref:e.id,filename:this._filename},bubbles:!0,composed:!0}))},leafNodeClass:`var-node`,scopeNodeClass:`tree-node`,showCheckboxes:!0,isChecked:e=>this._selectedSignalRefs.has(e.id)}}set hierarchyData(e){this._hierarchyData=e,this.updateTreeData()}get hierarchyData(){return this._hierarchyData}set data(e){this.hierarchyData=e}get data(){return this.hierarchyData}set filename(e){this._filename=e}get filename(){return this._filename}set selectedSignalRefs(e){this._selectedSignalRefs=new Set(e),this.updateTreeData()}get selectedSignalRefs(){return Array.from(this._selectedSignalRefs)}updateTreeData(){if(!this._hierarchyData){super.data=[];return}let e=[];this._hierarchyData.scopes&&this._hierarchyData.scopes.forEach(t=>{e.push(this.convertScopeToNode(t))}),this._hierarchyData.vars&&this._hierarchyData.vars.forEach(t=>{e.push(this.convertVarToNode(t))}),super.data=e}convertScopeToNode(e){let t=[];return e.scopes&&e.scopes.forEach(e=>{t.push(this.convertScopeToNode(e))}),e.vars&&e.vars.forEach(e=>{t.push(this.convertVarToNode(e))}),{name:e.name,id:e.ref,children:t}}convertVarToNode(e){return{name:e.name,id:e.ref}}};customElements.get(`files-tree`)||customElements.define(`files-tree`,_e);var ve=`:host,.settings-container{flex-direction:column;height:100%;display:flex;overflow:hidden}.settings-content{flex:1;padding:16px;overflow-y:auto}.settings-category{margin-bottom:30px}.category-title{color:var(--color-text);border-bottom:1px solid var(--color-border);margin-bottom:15px;padding-bottom:8px;font-size:16px;font-weight:600}.setting-row{justify-content:space-between;align-items:center;gap:20px;padding:12px 0;display:flex}.setting-row label{cursor:pointer;flex:1}.setting-label{color:var(--color-text);margin-bottom:4px;font-weight:500}.setting-description{color:var(--color-text-secondary,#888);font-size:13px}.setting-input{border:1px solid var(--color-border);background:var(--color-bg);min-width:200px;color:var(--color-text);border-radius:4px;padding:6px 10px;font-family:inherit;font-size:14px}input[type=checkbox].setting-input{cursor:pointer;width:20px;min-width:auto;height:20px}select.setting-input{cursor:pointer}.setting-input:focus{outline:2px solid var(--color-button-border-hover);outline-offset:1px}`,ye=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:`open`})}connectedCallback(){this.render(),this.loadSettings()}async loadSettings(){let e=h.getGrouped();for(let[t,n]of e)for(let e of n)try{let t=await de(e.path),n=t===void 0?e.defaultValue:t;this.updateInputValue(e.path,n)}catch(t){console.error(`Failed to load setting ${e.path}:`,t)}}updateInputValue(e,t){let n=this.shadowRoot?.querySelector(`[data-path="${e}"]`);n&&(n.type===`checkbox`?n.checked=!!t:n.value=t?.toString()||``)}async handleSettingChange(e,t,n){try{let r=t;n.type===`number`?r=parseFloat(t):n.type===`boolean`&&(r=t===!0||t===`true`),await fe(e,r),this.dispatchEvent(new CustomEvent(`setting-changed`,{bubbles:!0,composed:!0,detail:{path:e,value:r}}))}catch(t){console.error(`Failed to save setting ${e}:`,t),alert(`Failed to save setting: ${t}`)}}renderSetting(e){let{path:t,description:n,type:r}=e,i=t.replace(/\//g,`-`);switch(r){case`enum`:return`
                    <div class="setting-row">
                        <label for="${i}">
                            <div class="setting-label">${t.split(`/`).pop()}</div>
                            <div class="setting-description">${n}</div>
                        </label>
                        <select id="${i}" data-path="${t}" class="setting-input">
                            ${e.options?.map(e=>`<option value="${e.value}">${e.label}</option>`).join(``)||``}
                        </select>
                    </div>
                `;case`boolean`:return`
                    <div class="setting-row">
                        <label for="${i}">
                            <div class="setting-label">${t.split(`/`).pop()}</div>
                            <div class="setting-description">${n}</div>
                        </label>
                        <input type="checkbox" id="${i}" data-path="${t}" class="setting-input">
                    </div>
                `;case`number`:return`
                    <div class="setting-row">
                        <label for="${i}">
                            <div class="setting-label">${t.split(`/`).pop()}</div>
                            <div class="setting-description">${n}</div>
                        </label>
                        <input type="number" id="${i}" data-path="${t}" class="setting-input"
                            ${e.min===void 0?``:`min="${e.min}"`}
                            ${e.max===void 0?``:`max="${e.max}"`}
                            ${e.step===void 0?``:`step="${e.step}"`}>
                    </div>
                `;case`string`:default:return`
                    <div class="setting-row">
                        <label for="${i}">
                            <div class="setting-label">${t.split(`/`).pop()}</div>
                            <div class="setting-description">${n}</div>
                        </label>
                        <input type="text" id="${i}" data-path="${t}" class="setting-input">
                    </div>
                `}}render(){let e=h.getGrouped();this.shadowRoot.adoptedStyleSheets=[ce,m(ve)],this.shadowRoot.innerHTML=`
            <div class="settings-container">
                <div class="settings-content">
                    ${Array.from(e.entries()).map(([e,t])=>`
                        <div class="settings-category">
                            <div class="category-title">${e}</div>
                            ${t.map(e=>this.renderSetting(e)).join(``)}
                        </div>
                    `).join(``)}
                </div>
            </div>
        `;let t=h.getAll();for(let e of t){let t=this.shadowRoot.querySelector(`[data-path="${e.path}"]`);t&&(t.type===`checkbox`?t.addEventListener(`change`,()=>{this.handleSettingChange(e.path,t.checked,e)}):t.addEventListener(`change`,()=>{this.handleSettingChange(e.path,t.value,e)}))}}};customElements.get(`settings-page`)||customElements.define(`settings-page`,ye);var be=`:host{width:100%;height:100%;display:block;overflow:auto}.about-container{background:var(--color-bg);border:1px solid var(--color-border);max-width:600px;color:var(--color-text);border-radius:8px;margin:40px auto;padding:30px}.about-header{text-align:center;margin-bottom:20px}.about-title{margin:0 0 5px;font-size:24px;font-weight:700}.about-version{color:var(--color-text-secondary,#666);margin:0;font-size:14px}.about-content{text-align:center;margin:20px 0}.about-content p{margin:10px 0;line-height:1.5}.info-row{border-bottom:1px solid var(--color-border,#eee);justify-content:space-between;margin:8px 0;padding:8px 0;display:flex}.info-label{color:var(--color-text-secondary,#666);font-weight:500}.info-value{color:var(--color-text);font-family:monospace}.github-link{color:var(--link-color,#007bff);text-decoration:none}.github-link:hover{text-decoration:underline}`,xe=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[m(be)]}connectedCallback(){this.render()}render(){this.shadowRoot.innerHTML=`
            <div class="about-container">
                <div class="about-header">
                    <h1 class="about-title">Swell</h1>
                    <p class="about-version">Version 0.1.27</p>
                </div>
                <div class="about-content">
                    <p>A modern waveform viewer for digital design verification.</p>
                    <div class="info-row">
                        <span class="info-label">Build Commit:</span>
                        <span class="info-value">1e8f80f0</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">GitHub:</span>
                        <span class="info-value">
                            <a href="https://github.com/ecstrema/swell" 
                               class="github-link" 
                               target="_blank" 
                               rel="noopener noreferrer">
                                ecstrema/swell
                            </a>
                        </span>
                    </div>
                </div>
            </div>
        `}};customElements.define(`about-pane`,xe);function Se(e){if(!e){document.title=`Swell`;return}let t=e.split(/[/\\]/).pop()||e;document.title=`${t} - Swell`}var Ce=`:host{background-color:var(--color-bg);height:100vh;color:var(--color-text);font-family:var(--font-family,sans-serif);flex-direction:column;display:flex}.container{flex-direction:column;flex:1;display:flex;overflow:hidden}#workspace{flex:1;display:flex;overflow:hidden}.dockable-content{background-color:var(--color-bg-surface);flex-direction:column;width:100%;height:100%;display:flex;overflow:hidden}.empty-state{text-align:center;flex-direction:column;flex:1;justify-content:center;align-items:center;padding-bottom:20vh;display:flex}.row{justify-content:center;margin-top:1rem;display:flex}button{border:1px solid var(--color-button-border);color:var(--color-button-text);background-color:var(--color-button-bg);box-shadow:0 2px 2px var(--menu-shadow);cursor:pointer;border-radius:8px;padding:.6em 1.2em;font-family:inherit;font-size:1em;font-weight:500;transition:border-color .25s}button:hover{border-color:var(--color-button-border-hover);background-color:var(--color-bg-hover)}button:active{border-color:var(--color-button-border-hover);background-color:var(--color-bg-active)}`,we=`:host{--dock-border-color:var(--color-border);--dock-bg-color:var(--color-bg);--dock-tab-bg:var(--color-bg-surface);--dock-tab-active-bg:var(--color-bg-hover);--dock-tab-text:var(--color-text-muted);--dock-tab-active-text:var(--color-text);--dock-overlay-bg:#007acc33;--dock-accent:var(--color-primary);width:100%;height:100%;display:block;position:relative;overflow:hidden}.dock-root{width:100%;height:100%;display:flex}#drop-overlay{pointer-events:none;background:var(--dock-overlay-bg);border:2px solid var(--dock-accent);z-index:1000;display:none;position:absolute}`,Te=`:host{flex-direction:var(--direction,row);width:100%;height:100%;display:flex;overflow:hidden}.resizer{z-index:10;background:0 0;flex:0 0 4px;transition:background .2s}.resizer:hover{background:var(--color-accent,#007acc)}.resizer.row{cursor:ew-resize;width:4px;height:100%}.resizer.column{cursor:ns-resize;width:100%;height:4px}`,Ee=class extends HTMLElement{_node=null;_manager=null;set node(e){this._node=e,this.render()}set manager(e){this._manager=e}constructor(){super(),this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[m(Te)]}render(){if(!this._node||!this._manager)return;let e=this._node.direction===`row`?`row`:`column`;this.style.setProperty(`--direction`,e),this.shadowRoot.innerHTML=`
            <div id="container" style="display: contents;"></div>
        `;let t=this.shadowRoot.querySelector(`#container`);this._node.children.forEach((n,r)=>{if(r>0){let n=document.createElement(`div`);n.className=`resizer ${e}`,n.dataset.index=r.toString(),t.appendChild(n),n.addEventListener(`mousedown`,e=>this.onResizeStart(e,r-1,r))}this._manager.renderNode(n,t)})}onResizeStart(e,t,n){if(!this._node)return;e.preventDefault();let r=this._node.direction,i=r===`row`?e.clientX:e.clientY,a=this._node.children[t],o=this._node.children[n],s=a.weight+o.weight,c=a.weight,l=o.weight,u=this.shadowRoot.querySelector(`#container`),ee=Array.from(u.children).filter(e=>e.tagName.toLowerCase().startsWith(`dock-`)),d=ee[t],te=ee[n],f=d.getBoundingClientRect(),ne=te.getBoundingClientRect(),p=r===`row`?f.width+ne.width:f.height+ne.height,re=e=>{let t=((r===`row`?e.clientX:e.clientY)-i)/p*s,n=Math.max(.1,c+t),u=Math.max(.1,l-(n-c));a.weight=n,o.weight=u,d.style.flex=`${a.weight}`,te.style.flex=`${o.weight}`},m=()=>{window.removeEventListener(`mousemove`,re),window.removeEventListener(`mouseup`,m),document.body.style.cursor=``};document.body.style.cursor=r===`row`?`ew-resize`:`ns-resize`,window.addEventListener(`mousemove`,re),window.addEventListener(`mouseup`,m)}};customElements.define(`dock-box`,Ee);var De=`:host{background:var(--dock-bg-color);border:1px solid var(--dock-border-color);box-sizing:border-box;flex-direction:column;width:100%;min-width:0;height:100%;min-height:0;display:flex}.tabs-header{background:var(--dock-tab-bg);scrollbar-width:none;cursor:move;user-select:none;flex:0 0 30px;display:flex;overflow:auto hidden}.tabs-header::-webkit-scrollbar{display:none}.tabs-header.dragging{opacity:.5;cursor:grabbing!important}.tab{cursor:pointer;white-space:nowrap;height:30px;color:var(--dock-tab-text);background:var(--dock-tab-bg);border-right:1px solid var(--dock-border-color);user-select:none;align-items:center;padding:0 12px;font-size:13px;display:flex;position:relative}.tab.active{background:var(--dock-tab-active-bg);color:var(--dock-tab-active-text)}.tab:hover:not(.active){background:#ffffff0d}.tab.dragging{opacity:.5;cursor:grabbing!important}.tab.drag-over-left{border-left:2px solid var(--dock-accent,#007acc)}.tab.drag-over-right{border-right:2px solid var(--dock-accent,#007acc)}.content-area{flex:1;position:relative;overflow:hidden}.pane-content{width:100%;height:100%;display:none}.pane-content.active{display:block}.close-btn{opacity:.5;margin-left:8px;font-size:14px}.close-btn:hover{opacity:1}.empty-placeholder{background:var(--dock-bg-color);justify-content:center;align-items:center;width:100%;height:100%;display:flex}.empty-placeholder-content{text-align:center;color:var(--dock-tab-text);opacity:.6}.empty-placeholder-content h2{margin:0 0 .5rem;font-size:1.5rem;font-weight:400}.empty-placeholder-content p{margin:0;font-size:.95rem}.open-file-link{font-family:inherit;font-size:inherit;color:var(--color-link,#4a9eff);cursor:pointer;opacity:1;background:0 0;border:none;padding:0;text-decoration:underline}.open-file-link:hover{color:var(--color-link-hover,#6eb3ff)}.open-file-link:active{color:var(--color-link-active,#2e7fd8)}`,Oe=class extends HTMLElement{_node=null;_manager=null;_dragOverHandler=null;_dragLeaveHandler=null;_dropHandler=null;set node(e){this._node=e,this.render()}set manager(e){this._manager=e}constructor(){super(),this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[m(De)],this._dragOverHandler=e=>{this._manager&&this._node&&this._manager.handleDragOver(e,this._node,this)},this._dragLeaveHandler=()=>{this._manager&&this._manager.handleDragLeave()},this._dropHandler=e=>{this._manager&&this._node&&this._manager.handleDrop(e,this._node,this)}}connectedCallback(){this.addEventListener(`dragover`,this._dragOverHandler),this.addEventListener(`dragleave`,this._dragLeaveHandler),this.addEventListener(`drop`,this._dropHandler)}disconnectedCallback(){this._dragOverHandler&&this.removeEventListener(`dragover`,this._dragOverHandler),this._dragLeaveHandler&&this.removeEventListener(`dragleave`,this._dragLeaveHandler),this._dropHandler&&this.removeEventListener(`drop`,this._dropHandler)}render(){if(!this._node||!this._manager)return;let e=this._node.activeId||(this._node.children.length>0?this._node.children[0].id:null);if(this._node.children.length===0){this.shadowRoot.innerHTML=`
                <div class="empty-placeholder">
                    <div class="empty-placeholder-content">
                        <h2>No Open Editors</h2>
                        <p><button id="open-file-btn" class="open-file-link">open a file</button> to get started</p>
                    </div>
                </div>
            `;let e=this.shadowRoot.querySelector(`#open-file-btn`);e&&e.addEventListener(`click`,()=>{this.dispatchEvent(new CustomEvent(`file-open-request`,{bubbles:!0,composed:!0}))});return}this.shadowRoot.innerHTML=`
            <div class="tabs-header" draggable="true" title="Drag to move entire dock">
                ${this._node.children.map(t=>`
                    <div class="tab ${t.id===e?`active`:``}" data-id="${t.id}" draggable="true">
                        ${t.title}
                        ${t.closable===!1?``:`<span class="close-btn">×</span>`}
                    </div>
                `).join(``)}
            </div>
            <div class="content-area"></div>
        `;let t=this.shadowRoot.querySelector(`.tabs-header`);t.addEventListener(`click`,e=>{let t=e.target.closest(`.tab`);if(t){let n=t.dataset.id;e.target.classList.contains(`close-btn`)?this.closePane(n):this.setActivePane(n)}}),t.addEventListener(`dragstart`,e=>{e.target.closest(`.tab`)?e.preventDefault():this._manager&&this._node&&(this._manager.handleStackDragStart(this._node),e.dataTransfer&&(e.dataTransfer.effectAllowed=`move`,e.dataTransfer.setData(`text/plain`,this._node.id)),t.classList.add(`dragging`))}),t.addEventListener(`dragend`,()=>{t.classList.remove(`dragging`)});let n=this.shadowRoot.querySelectorAll(`.tab`);n.forEach(e=>{let t=e;t.addEventListener(`dragstart`,e=>{let n=t.dataset.id,r=this._node.children.find(e=>e.id===n);r&&this._manager&&(this._manager.handleDragStart(r,this._node),e.dataTransfer&&(e.dataTransfer.effectAllowed=`move`,e.dataTransfer.setData(`text/plain`,n)),t.classList.add(`dragging`))}),t.addEventListener(`dragend`,()=>{t.classList.remove(`dragging`),n.forEach(e=>e.classList.remove(`drag-over-left`,`drag-over-right`))}),t.addEventListener(`dragover`,e=>{if(e.preventDefault(),e.stopPropagation(),!this._manager)return;let r=this._manager.getDraggedPane();if(r&&r.sourceStack.id===this._node.id){let r=t.getBoundingClientRect(),i=r.left+r.width/2,a=e.clientX<i;n.forEach(e=>e.classList.remove(`drag-over-left`,`drag-over-right`)),a?t.classList.add(`drag-over-left`):t.classList.add(`drag-over-right`)}}),t.addEventListener(`dragleave`,()=>{t.classList.remove(`drag-over-left`,`drag-over-right`)}),t.addEventListener(`drop`,e=>{if(e.preventDefault(),e.stopPropagation(),!this._manager)return;let r=this._manager.getDraggedPane();if(r&&r.sourceStack.id===this._node.id){let i=t.dataset.id,a=this._node.children.findIndex(e=>e.id===i);if(a!==-1){let n=t.getBoundingClientRect(),i=n.left+n.width/2,o=e.clientX<i?a:a+1;this._manager.handleTabReorder(r.pane,this._node,o)}n.forEach(e=>e.classList.remove(`drag-over-left`,`drag-over-right`))}})});let r=this.shadowRoot.querySelector(`.content-area`);this._node.children.forEach(t=>{let n=document.createElement(`div`);n.className=`pane-content ${t.id===e?`active`:``}`,n.dataset.id=t.id;let i=this._manager.getContent(t.contentId,t.id);n.appendChild(i),r.appendChild(n)})}setActivePane(e){this._node&&(this._node.activeId=e,this.render(),this.dispatchEvent(new CustomEvent(`pane-select`,{detail:{id:e},bubbles:!0,composed:!0})))}closePane(e){this.dispatchEvent(new CustomEvent(`pane-close`,{detail:{id:e},bubbles:!0,composed:!0}))}};customElements.define(`dock-stack`,Oe);var ke=class extends HTMLElement{_layout=null;_contentRegistry=new Map;_draggedPane=null;_draggedStack=null;_dropOverlay=null;constructor(){super(),this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[ce,m(we)]}set layout(e){this._layout=e,this.render()}get layout(){return this._layout}registerContent(e,t){this._contentRegistry.set(e,t)}getContent(e,t){let n=this._contentRegistry.get(e);if(n)return n(t);let r=document.createElement(`div`);return r.textContent=`Content not found: ${e}`,r}connectedCallback(){this.render(),this.addEventListener(`dragover`,e=>e.preventDefault())}render(){if(!this._layout){this.shadowRoot.innerHTML=`<div>No layout defined</div>`;return}this.shadowRoot.innerHTML=`
            <div class="dock-root"></div>
            <div id="drop-overlay"></div>
        `;let e=this.shadowRoot.querySelector(`.dock-root`);this._dropOverlay=this.shadowRoot.querySelector(`#drop-overlay`),this.renderNode(this._layout.root,e)}renderNode(e,t){let n;e.type===`box`?(n=document.createElement(`dock-box`),n.manager=this,n.node=e):(n=document.createElement(`dock-stack`),n.manager=this,n.node=e),n.style.flex=`${e.weight}`,t.appendChild(n)}handleDragStart(e,t){this._draggedPane={pane:e,sourceStack:t}}handleStackDragStart(e){this._draggedStack=e}handleTabReorder(e,t,n){let r=t.children.findIndex(t=>t.id===e.id);if(r===-1||r===n)return;t.children.splice(r,1);let i=r<n?n-1:n;t.children.splice(i,0,e),this.render()}getDraggedPane(){return this._draggedPane}getDraggedStack(){return this._draggedStack}handleDragOver(e,t,n){if(!this._draggedPane&&!this._draggedStack)return;e.preventDefault();let r=n.getBoundingClientRect(),i=this.getBoundingClientRect(),a=e.clientX-r.left,o=e.clientY-r.top,s=this.getDropZone(a,o,r.width,r.height);this.showDropOverlay(r,i,s)}handleDragLeave(){this._dropOverlay&&(this._dropOverlay.style.display=`none`)}handleDrop(e,t,n){if(!this._draggedPane&&!this._draggedStack)return;this.handleDragLeave();let r=n.getBoundingClientRect(),i=e.clientX-r.left,a=e.clientY-r.top,o=this.getDropZone(i,a,r.width,r.height);this._draggedStack?(this._draggedStack.id!==t.id&&this.moveStack(this._draggedStack,t,o),this._draggedStack=null):this._draggedPane&&=(this.movePane(this._draggedPane.pane,this._draggedPane.sourceStack,t,o),null),this.render()}getDropZone(e,t,n,r){let i=.2;return e<n*i?`left`:e>n*(1-i)?`right`:t<r*i?`top`:t>r*(1-i)?`bottom`:`center`}showDropOverlay(e,t,n){if(!this._dropOverlay)return;let r=e.top-t.top,i=e.left-t.left,a=e.width,o=e.height;n===`left`&&(a/=2),n===`right`&&(i+=a/2,a/=2),n===`top`&&(o/=2),n===`bottom`&&(r+=o/2,o/=2),Object.assign(this._dropOverlay.style,{display:`block`,top:`${r}px`,left:`${i}px`,width:`${a}px`,height:`${o}px`})}movePane(e,t,n,r){t.children=t.children.filter(t=>t.id!==e.id),t.activeId===e.id&&(t.activeId=t.children.length>0?t.children[0].id:null),r===`center`?(n.children.push(e),n.activeId=e.id):this.splitStack(n,e,r),this.shouldCleanupEmptyStacks()&&this.cleanupEmptyNodes(this._layout.root)}moveStack(e,t,n){if(n===`center`)return;let r=this.findParent(this._layout.root,e.id);if(!r)return;let i=r.children.indexOf(e);if(i===-1)return;if(r.children.splice(i,1),r.children.length===1){let e=this.findParent(this._layout.root,r.id);if(e){let t=e.children.indexOf(r),n=r.children[0];n.weight=r.weight,e.children[t]=n}}let a=this.findParent(this._layout.root,t.id),o=n===`left`||n===`right`?`row`:`column`,s=n===`right`||n===`bottom`;if(a)if(a.direction===o){let n=a.children.indexOf(t);e.weight=t.weight/2,t.weight/=2,a.children.splice(s?n+1:n,0,e)}else{let n=a.children.indexOf(t);e.weight=t.weight/2,t.weight/=2;let r={id:`box-`+Math.random().toString(36).substring(2,11),type:`box`,direction:o,weight:t.weight*2,children:s?[t,e]:[e,t]};a.children[n]=r}else{let t=this._layout.root;e.weight=1,this._layout.root={id:`box-`+Math.random().toString(36).substring(2,11),type:`box`,direction:o,weight:1,children:s?[t,e]:[e,t]}}}splitStack(e,t,n){let r=this.findParent(this._layout.root,e.id);if(!r){let e=this._layout.root,r=n===`left`||n===`right`?`row`:`column`,i=n===`right`||n===`bottom`,a={id:`stack-`+Math.random().toString(36).substring(2,11),type:`stack`,weight:1,children:[t],activeId:t.id};this._layout.root={id:`box-root`,type:`box`,direction:r,weight:1,children:i?[e,a]:[a,e]};return}let i=n===`left`||n===`right`?`row`:`column`,a=n===`right`||n===`bottom`,o={id:`stack-`+Math.random().toString(36).substring(2,11),type:`stack`,weight:e.weight/2,children:[t],activeId:t.id};if(e.weight/=2,r.direction===i){let t=r.children.indexOf(e);r.children.splice(a?t+1:t,0,o)}else{let t=r.children.indexOf(e),n={id:`box-`+Math.random().toString(36).substring(2,11),type:`box`,direction:i,weight:e.weight*2,children:a?[e,o]:[o,e]};r.children[t]=n}}findParent(e,t){if(e.type===`box`)for(let n of e.children){if(n.id===t)return e;let r=this.findParent(n,t);if(r)return r}return null}cleanupEmptyNodes(e){return e.type===`box`?(e.children=e.children.filter(e=>e.type===`stack`&&e.children.length===0?!1:e.type===`box`?!this.cleanupEmptyNodes(e):!0),e.children.length===0):!1}countStacks(e){if(e.type===`stack`)return 1;let t=0;for(let n of e.children)t+=this.countStacks(n);return t}shouldCleanupEmptyStacks(){return this._layout?this.countStacks(this._layout.root)>1:!1}};customElements.define(`dock-manager`,ke);var Ae=`:host{height:100%;color:var(--color-text);background-color:var(--color-bg-surface);flex-direction:column;display:flex}.file-header{color:var(--color-text-muted);border-bottom:1px solid var(--color-border);padding:1rem 2rem;font-size:.9em}.display-container{flex:1;display:flex;overflow-y:auto}.signals-tree-container{flex-direction:column;flex-shrink:0;width:250px;min-width:200px;max-width:400px;display:flex}.add-timeline-btn{background-color:var(--color-bg);color:var(--color-text);border:1px solid var(--color-border);cursor:pointer;border-radius:4px;margin:1rem;padding:.5rem 1rem;font-size:.9em;transition:background-color .2s}.add-timeline-btn:hover{background-color:var(--color-bg-surface)}.waveforms-container{flex-direction:column;flex:1;gap:0;padding:0;display:flex}.signal-item{border:1px solid var(--color-border);background-color:var(--color-bg);border-radius:4px;padding:0}.timeline-item{background-color:#0000;border:none;padding:0}canvas{border:1px solid var(--color-border);border-radius:2px;width:100%;height:40px}.empty-message{color:var(--color-text-muted);text-align:center;margin-top:2rem;font-style:italic}`,je=`:host{border-right:1px solid var(--color-border);min-width:200px;max-width:300px}.signal-node{cursor:default;color:var(--color-text);margin-left:10px;padding:4px 8px;font-weight:500}.signal-node:hover{background-color:var(--color-bg-hover)}`,Me=class extends he{_signals=[];constructor(){if(super(),this.shadowRoot){let e=Array.from(this.shadowRoot.adoptedStyleSheets);this.shadowRoot.adoptedStyleSheets=[...e,m(je)]}this.config={onLeafClick:e=>{},leafNodeClass:`signal-node`,scopeNodeClass:`tree-node`}}set signals(e){this._signals=e,this.updateTreeData()}get signals(){return this._signals}updateTreeData(){super.data=this._signals.map(e=>({name:e.name,id:e.ref}))}};customElements.get(`selected-signals-tree`)||customElements.define(`selected-signals-tree`,Me);var Ne=`:host{background-color:var(--color-bg-surface,#2d2d2d);width:100%;display:block}.timeline-container{flex-direction:column;gap:.5rem;width:100%;padding:.5rem;display:flex;position:relative}.timeline-controls{justify-content:flex-end;align-items:center;gap:.5rem;display:flex}.timeline-controls button{border:1px solid var(--color-border,#444);background-color:var(--color-button-bg,#3a3a3a);width:32px;height:32px;color:var(--color-text,#fff);cursor:pointer;border-radius:4px;justify-content:center;align-items:center;font-size:16px;font-weight:700;transition:background-color .2s;display:flex}.timeline-controls button:hover{background-color:var(--color-bg-hover,#4a4a4a)}.timeline-controls button:active{background-color:var(--color-bg-active,#555)}.timeline-wrapper{width:100%;position:relative}.timeline-canvas{border:1px solid var(--color-border,#444);background-color:var(--color-bg,#1e1e1e);cursor:crosshair;border-radius:4px;width:100%;height:60px;display:block}.scrollbar{pointer-events:none;height:20px;padding:0 8px;position:absolute;bottom:8px;left:0;right:0}.scrollbar-track{border:1px solid var(--color-border,#444);pointer-events:auto;background-color:#1e1e1ecc;border-radius:4px;width:100%;height:100%;position:relative}.scrollbar-thumb{background-color:var(--color-button-bg,#4a4a4a);cursor:grab;border-radius:3px;height:100%;transition:background-color .2s;position:absolute}.scrollbar-thumb:hover{background-color:var(--color-bg-hover,#5a5a5a)}.scrollbar-thumb:active{cursor:grabbing;background-color:var(--color-bg-active,#666)}`,Pe=class extends HTMLElement{_startTime=0;_endTime=1e6;_totalStartTime=0;_totalEndTime=1e6;canvas=null;scrollbarThumb=null;zoomInBtn=null;zoomOutBtn=null;zoomFitBtn=null;isDragging=!1;dragStartX=0;dragStartScrollLeft=0;boundHandleResize;boundHandleScrollbarMouseDown;boundHandleScrollbarMouseMove;boundHandleScrollbarMouseUp;boundHandleWheel;boundZoomIn;boundZoomOut;boundZoomToFit;resizeObserver=null;constructor(){super(),this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[m(Ne)],this.boundHandleResize=this.handleResize.bind(this),this.boundHandleScrollbarMouseDown=this.handleScrollbarMouseDown.bind(this),this.boundHandleScrollbarMouseMove=this.handleScrollbarMouseMove.bind(this),this.boundHandleScrollbarMouseUp=this.handleScrollbarMouseUp.bind(this),this.boundHandleWheel=this.handleWheel.bind(this),this.boundZoomIn=()=>this.zoomIn(),this.boundZoomOut=()=>this.zoomOut(),this.boundZoomToFit=()=>this.zoomToFit()}connectedCallback(){this.render(),this.setupEventListeners()}disconnectedCallback(){this.removeEventListeners(),this.resizeObserver&&=(this.resizeObserver.disconnect(),null),this.isDragging&&=(document.removeEventListener(`mousemove`,this.boundHandleScrollbarMouseMove),document.removeEventListener(`mouseup`,this.boundHandleScrollbarMouseUp),!1)}set visibleRange(e){this._startTime=e.start,this._endTime=e.end,this.updateCanvas(),this.updateScrollbar()}get visibleRange(){return{start:this._startTime,end:this._endTime}}set totalRange(e){this._totalStartTime=e.start,this._totalEndTime=e.end,this.updateCanvas(),this.updateScrollbar()}get totalRange(){return{start:this._totalStartTime,end:this._totalEndTime}}zoomIn(e=2){let t=this._endTime-this._startTime;if(t<=0){console.warn(`Cannot zoom: invalid time range`);return}let n=t/e;if(n<1){console.warn(`Cannot zoom in further: minimum zoom reached`);return}let r=(this._startTime+this._endTime)/2,i=r-n/2,a=r+n/2;if(i<this._totalStartTime&&(i=this._totalStartTime,a=i+n),a>this._totalEndTime&&(a=this._totalEndTime,i=a-n),i>=a){console.warn(`Cannot zoom: would create invalid range`);return}this.setVisibleRange(i,a)}zoomOut(e=2){let t=this._endTime-this._startTime;if(t<=0){console.warn(`Cannot zoom: invalid time range`);return}let n=this._totalEndTime-this._totalStartTime,r=Math.min(t*e,n),i=(this._startTime+this._endTime)/2,a=i-r/2,o=i+r/2;if(a<this._totalStartTime&&(a=this._totalStartTime,o=a+r),o>this._totalEndTime&&(o=this._totalEndTime,a=o-r),a>=o){console.warn(`Cannot zoom: would create invalid range`);return}this.setVisibleRange(a,o)}zoomToFit(){this.setVisibleRange(this._totalStartTime,this._totalEndTime)}setVisibleRange(e,t){this._startTime=e,this._endTime=t,this.updateCanvas(),this.updateScrollbar(),this.dispatchEvent(new CustomEvent(`range-changed`,{detail:{start:e,end:t},bubbles:!0,composed:!0}))}render(){this.shadowRoot.innerHTML=`
      <div class="timeline-container">
        <div class="timeline-controls">
          <button id="zoom-in-btn" title="Zoom In">+</button>
          <button id="zoom-out-btn" title="Zoom Out">−</button>
          <button id="zoom-fit-btn" title="Zoom to Fit">⟷</button>
        </div>
        <div class="timeline-wrapper">
          <canvas class="timeline-canvas"></canvas>
          <div class="scrollbar">
            <div class="scrollbar-track">
              <div class="scrollbar-thumb"></div>
            </div>
          </div>
        </div>
      </div>
    `,this.canvas=this.shadowRoot.querySelector(`.timeline-canvas`),this.scrollbarThumb=this.shadowRoot.querySelector(`.scrollbar-thumb`),this.canvas&&requestAnimationFrame(()=>{if(this.canvas){let e=this.canvas.getBoundingClientRect();this.canvas.width=e.width,this.canvas.height=e.height,this.updateCanvas()}})}setupEventListeners(){this.zoomInBtn=this.shadowRoot.querySelector(`#zoom-in-btn`),this.zoomOutBtn=this.shadowRoot.querySelector(`#zoom-out-btn`),this.zoomFitBtn=this.shadowRoot.querySelector(`#zoom-fit-btn`),this.zoomInBtn?.addEventListener(`click`,this.boundZoomIn),this.zoomOutBtn?.addEventListener(`click`,this.boundZoomOut),this.zoomFitBtn?.addEventListener(`click`,this.boundZoomToFit),this.scrollbarThumb&&this.scrollbarThumb.addEventListener(`mousedown`,this.boundHandleScrollbarMouseDown),this.canvas&&this.canvas.addEventListener(`wheel`,this.boundHandleWheel),window.addEventListener(`resize`,this.boundHandleResize),this.resizeObserver=new ResizeObserver(()=>{this.handleResize()}),this.resizeObserver.observe(this)}removeEventListeners(){this.zoomInBtn?.removeEventListener(`click`,this.boundZoomIn),this.zoomOutBtn?.removeEventListener(`click`,this.boundZoomOut),this.zoomFitBtn?.removeEventListener(`click`,this.boundZoomToFit),this.scrollbarThumb&&this.scrollbarThumb.removeEventListener(`mousedown`,this.boundHandleScrollbarMouseDown),this.canvas&&this.canvas.removeEventListener(`wheel`,this.boundHandleWheel),window.removeEventListener(`resize`,this.boundHandleResize)}handleScrollbarMouseDown(e){e.preventDefault(),this.isDragging=!0,this.dragStartX=e.clientX,this.dragStartScrollLeft=this.scrollbarThumb.getBoundingClientRect().left,document.addEventListener(`mousemove`,this.boundHandleScrollbarMouseMove),document.addEventListener(`mouseup`,this.boundHandleScrollbarMouseUp)}handleScrollbarMouseMove(e){if(!this.isDragging)return;let t=this.shadowRoot.querySelector(`.scrollbar-track`);if(!t)return;let n=t.getBoundingClientRect(),r=this.scrollbarThumb.getBoundingClientRect(),i=e.clientX-this.dragStartX,a=this.dragStartScrollLeft+i-n.left,o=n.width-r.width,s=Math.max(0,Math.min(1,a/o));this._totalEndTime-this._totalStartTime;let c=this._endTime-this._startTime,l=this._totalEndTime-c,u=this._totalStartTime+(l-this._totalStartTime)*s;this.setVisibleRange(u,u+c)}handleScrollbarMouseUp(){this.isDragging=!1,document.removeEventListener(`mousemove`,this.boundHandleScrollbarMouseMove),document.removeEventListener(`mouseup`,this.boundHandleScrollbarMouseUp)}handleWheel(e){e.preventDefault(),e.deltaY<0?this.zoomIn(1.2):this.zoomOut(1.2)}handleResize(){if(this.canvas){let e=this.canvas.getBoundingClientRect();this.canvas.width=e.width,this.canvas.height=e.height,this.updateCanvas()}}updateCanvas(){if(!this.canvas)return;let e=this.canvas.getContext(`2d`);if(!e)return;let t=this.canvas.width,n=this.canvas.height;e.fillStyle=getComputedStyle(this).getPropertyValue(`--color-bg`)||`#1e1e1e`,e.fillRect(0,0,t,n),e.strokeStyle=getComputedStyle(this).getPropertyValue(`--color-border`)||`#444`,e.lineWidth=1,e.beginPath(),e.moveTo(0,n-1),e.lineTo(t,n-1),e.stroke();let r=this._endTime-this._startTime;t/r;let i=r/(t/80),a=10**Math.floor(Math.log10(i)),o=i/a,s;s=o<=1?a:o<=2?2*a:o<=5?5*a:10*a,e.fillStyle=getComputedStyle(this).getPropertyValue(`--color-text`)||`#fff`,e.font=`10px sans-serif`,e.textAlign=`center`;let c=Math.ceil(this._startTime/s)*s;for(let i=c;i<=this._endTime;i+=s){let a=(i-this._startTime)/r*t;e.beginPath(),e.moveTo(a,n-1),e.lineTo(a,n-10),e.stroke();let o=this.formatTime(i);e.fillText(o,a,n-15)}}updateScrollbar(){if(!this.scrollbarThumb)return;let e=this._totalEndTime-this._totalStartTime,t=this._endTime-this._startTime,n=Math.max(20,t/e*100);this.scrollbarThumb.style.width=n+`%`;let r=e-t,i=r>0?(this._startTime-this._totalStartTime)/r*(100-n):0;this.scrollbarThumb.style.left=i+`%`}formatTime(e){return e>=1e9?(e/1e9).toFixed(2)+`s`:e>=1e6?(e/1e6).toFixed(2)+`ms`:e>=1e3?(e/1e3).toFixed(2)+`μs`:e>=1?e.toFixed(0)+`ns`:(e*1e3).toFixed(2)+`ps`}};customElements.get(`timeline-view`)||customElements.define(`timeline-view`,Pe);var Fe=class extends HTMLElement{_filename=``;selectedSignals=[];signalsContainer=null;selectedSignalsTree;boundHandleSignalSelect;boundHandleRangeChanged;boundHandleZoomCommand;boundHandleAddTimeline;visibleStart=0;visibleEnd=1e6;timeRangeInitialized=!1;timelineCounter=0;resizeObserver=null;constructor(){super(),this.attachShadow({mode:`open`}),this.boundHandleSignalSelect=this.handleSignalSelect.bind(this),this.boundHandleRangeChanged=this.handleRangeChanged.bind(this),this.boundHandleZoomCommand=this.handleZoomCommand.bind(this),this.boundHandleAddTimeline=this.handleAddTimeline.bind(this),this.shadowRoot.adoptedStyleSheets=[ce,m(Ae)],this.selectedSignalsTree=new Me,this.addTimelineSignal(),this.render()}get filename(){return this._filename}set filename(e){this._filename=e,this.render()}connectedCallback(){document.addEventListener(`signal-select`,this.boundHandleSignalSelect),this.addEventListener(`range-changed`,this.boundHandleRangeChanged),this.addEventListener(`zoom-command`,this.boundHandleZoomCommand),this.resizeObserver=new ResizeObserver(()=>{this.handleContainerResize()}),this.resizeObserver.observe(this)}disconnectedCallback(){document.removeEventListener(`signal-select`,this.boundHandleSignalSelect),this.removeEventListener(`range-changed`,this.boundHandleRangeChanged),this.removeEventListener(`zoom-command`,this.boundHandleZoomCommand),this.resizeObserver&&=(this.resizeObserver.disconnect(),null)}handleRangeChanged(e){let{start:t,end:n}=e.detail;this.setVisibleRange(t,n),this.selectedSignals.forEach(r=>{r.isTimeline&&r.timeline&&r.timeline!==e.target&&(r.timeline.visibleRange={start:t,end:n})})}handleZoomCommand(e){let{action:t}=e.detail;this.selectedSignals.forEach(e=>{if(e.isTimeline&&e.timeline)switch(t){case`zoom-in`:e.timeline.zoomIn();break;case`zoom-out`:e.timeline.zoomOut();break;case`zoom-fit`:e.timeline.zoomToFit();break}})}addTimelineSignal(){this.timelineCounter++;let e=new Pe,t=`Timeline ${this.timelineCounter}`;this.timeRangeInitialized&&(e.totalRange={start:this.visibleStart,end:this.visibleEnd},e.visibleRange={start:this.visibleStart,end:this.visibleEnd}),this.selectedSignals.push({name:t,ref:-this.timelineCounter,isTimeline:!0,timeline:e}),this.updateSelectedSignalsTree()}handleAddTimeline(){this.addTimelineSignal(),this.render()}handleSignalSelect(e){let{name:t,ref:n,filename:r}=e.detail;if(r!==this._filename||this.selectedSignals.some(e=>e.ref===n))return;let i=document.createElement(`canvas`);i.width=800,i.height=40,this.selectedSignals.push({name:t,ref:n,canvas:i,isTimeline:!1}),this.updateSelectedSignalsTree(),this.render(),this.setupAndPaintCanvas(i,n)}updateSelectedSignalsTree(){this.selectedSignalsTree.signals=this.selectedSignals.map(e=>({name:e.name,ref:e.ref})),this.dispatchEvent(new CustomEvent(`selected-signals-changed`,{detail:{filename:this._filename,signalRefs:this.selectedSignals.filter(e=>!e.isTimeline).map(e=>e.ref)},bubbles:!0,composed:!0}))}setupAndPaintCanvas(e,t){requestAnimationFrame(()=>{e.width=e.clientWidth||800,this.paintSignal(e,t)})}handleContainerResize(){this.selectedSignals.forEach(e=>{if(e.canvas){let t=e.canvas.clientWidth||800;e.canvas.width!==t&&(e.canvas.width=t,this.paintSignal(e.canvas,e.ref))}})}parseSignalValue(e){let t=parseInt(e,2);if(!isNaN(t))return t;let n=parseInt(e,10);return isNaN(n)?0:n}async initializeTimeRange(e){if(!(this.timeRangeInitialized||!this._filename))try{let t=await n(this._filename,e,0,0x38d7ea4c68000);t.length>0&&(this.visibleStart=t[0].time,this.visibleEnd=t[t.length-1].time,this.timeRangeInitialized=!0,this.selectedSignals.forEach(e=>{e.isTimeline&&e.timeline&&(e.timeline.totalRange={start:this.visibleStart,end:this.visibleEnd},e.timeline.visibleRange={start:this.visibleStart,end:this.visibleEnd})}))}catch(e){console.error(`Error initializing time range:`,e)}}async paintSignal(e,t){if(this._filename)try{await this.initializeTimeRange(t);let r=await n(this._filename,t,this.visibleStart,this.visibleEnd),i=e.getContext(`2d`);if(!i||(i.fillStyle=`#1e1e1e`,i.fillRect(0,0,e.width,e.height),r.length===0))return;let a=r[0].time,o=r[r.length-1].time-a||1;i.strokeStyle=`#4CAF50`,i.lineWidth=2,i.beginPath(),r.forEach((t,n)=>{let s=(t.time-a)/o*e.width,c=this.parseSignalValue(t.value),l=e.height-(c>0?e.height*.8:e.height*.2);if(n===0)i.moveTo(s,l);else{let t=r[n-1];(t.time-a)/o*e.width;let c=this.parseSignalValue(t.value),u=e.height-(c>0?e.height*.8:e.height*.2);i.lineTo(s,u),i.lineTo(s,l)}}),i.stroke()}catch(e){console.error(`Error painting signal:`,e)}}async setVisibleRange(e,t){if(e<0||t<0)throw Error(`Invalid time range: start (${e}) and end (${t}) must be non-negative`);if(e>=t)throw Error(`Invalid time range: start (${e}) must be less than end (${t})`);this.visibleStart=e,this.visibleEnd=t,await Promise.all(this.selectedSignals.filter(e=>!e.isTimeline&&e.canvas).map(e=>this.paintSignal(e.canvas,e.ref)))}getVisibleRange(){return{start:this.visibleStart,end:this.visibleEnd}}getSelectedSignalRefs(){return this.selectedSignals.filter(e=>!e.isTimeline).map(e=>e.ref)}render(){if(!this.shadowRoot)return;this.shadowRoot.innerHTML=`
      <div class="file-header">
        Current File: <strong>${this._filename}</strong>
      </div>
      <div class="display-container">
        <div id="signals-tree-container" class="signals-tree-container"></div>
        <div class="waveforms-container" id="waveforms-container">
          ${this.selectedSignals.length===0?`<div class="empty-message">Select signals from the left panel to display them here</div>`:``}
        </div>
      </div>
    `;let e=this.shadowRoot.querySelector(`#signals-tree-container`);if(e){e.appendChild(this.selectedSignalsTree);let t=document.createElement(`button`);t.className=`add-timeline-btn`,t.textContent=`+ Add Timeline`,t.addEventListener(`click`,this.boundHandleAddTimeline),e.appendChild(t)}this.signalsContainer=this.shadowRoot.querySelector(`#waveforms-container`),this.signalsContainer&&this.selectedSignals.forEach(e=>{let t=document.createElement(`div`);t.className=e.isTimeline?`signal-item timeline-item`:`signal-item`,e.isTimeline&&e.timeline?t.appendChild(e.timeline):e.canvas&&t.appendChild(e.canvas),this.signalsContainer.appendChild(t)})}};customElements.get(`file-display`)||customElements.define(`file-display`,Fe);var Ie=class{fileResources=new Map;activeFileId=null;getFileIds(){return Array.from(this.fileResources.keys())}getActiveFileId(){return this.activeFileId}setActiveFileId(e){this.activeFileId=e}hasFile(e){return this.fileResources.has(e)}getFileResources(e){return this.fileResources.get(e)}getAllFileResources(){return this.fileResources}async handleFileOpen(){try{let e=await o();return e?await s(e):null}catch(e){return console.error(`Error loading file:`,e),null}}async handleOpenExample(e){try{let{loadExampleFile:t}=await f(async()=>{let{loadExampleFile:e}=await import(`./backend-DthrPGwh.js`);return{loadExampleFile:e}},__vite__mapDeps([4,5,1]));return await t(e)}catch(e){return console.error(`Error loading example file:`,e),null}}async refreshFiles(e,t){try{let n=await i();for(let[e,r]of this.fileResources)n.includes(e)||(t&&t(e),r.element.remove(),this.fileResources.delete(e));for(let t of n)if(!this.fileResources.has(t)){let n=new Fe;n.filename=t;let r=null;try{r=await a(t)}catch(e){console.error(`Error loading hierarchy for`,t,e)}this.fileResources.set(t,{element:n,hierarchy:r}),e&&await e(t)}let r=Array.from(this.fileResources.keys());return this.activeFileId&&!this.fileResources.has(this.activeFileId)&&(this.activeFileId=null),!this.activeFileId&&r.length>0&&(this.activeFileId=r[r.length-1]),this.activeFileId?Se(this.activeFileId):Se(null),{fileIds:r,activeFileId:this.activeFileId}}catch(e){return console.error(`Error refreshing files:`,e),{fileIds:[],activeFileId:null}}}async closeFile(e){try{await t(e)}catch(e){console.error(e)}}},Le=class{commands=new Map;register(e){this.commands.set(e.id,e)}unregister(e){this.commands.delete(e)}async execute(e){let t=this.commands.get(e);if(!t)return!1;try{return await t.handler(),!0}catch(t){return console.error(`Error executing command ${e}:`,t),!1}}get(e){return this.commands.get(e)}getAll(){return Array.from(this.commands.values())}has(e){return this.commands.has(e)}},Re=`long-inflexible-nondirectional`,ze=`long-inflexible-directional`,Be=(1n<<15n)-1n,Ve=(1n<<160n)-1n^Be,He=Ve,Ue=/(\S)\+/g,We=/\+{2,}/gi,Ge=/\s+/gi,Ke=(e,t)=>{try{return e()}catch{return t}},qe=e=>Qe(e)?e:[e],Je=(e,t)=>e<t?-1:e>t?1:0,Ye=e=>{let t=[];for(let n=0n;e>0n;n+=1n,e>>=1n)e&1n&&t.push(1n<<n);return t},Xe=e=>{if(e.length===0)return[];if(e.length===1){let t=e[0];return Qe(t)?t.length<=1?[t]:t.map(e=>[e]):[[t]]}let t=e.map(qe),n=t[0],r=Xe(t.slice(1)),i=[];for(let e of n)if(r.length)for(let t of r)i.push([e,...t]);else i.push([e]);return i},Ze=e=>e[0],Qe=e=>Array.isArray(e),$e=e=>e instanceof KeyboardEvent,g=(()=>{let e=(()=>typeof navigator==`object`?/mac|ipod|iphone|ipad/i.test(navigator.platform):typeof globalThis.process==`object`?globalThis.process.platform===`darwin`:!1)();return()=>e})(),et=e=>e instanceof MouseEvent,tt=e=>typeof e==`string`,nt=e=>e===void 0,rt=e=>e[e.length-1],it=e=>{let t=new Map;return n=>{let r=t.get(n);if(!nt(r)||t.has(n))return r;let i=e(n);return t.set(n,i),i}},at=()=>!1,ot=e=>e.reduce((e,t)=>e|t,0n),st=(e,t)=>t.map(t=>{let n=e.slice(0,-1),r=rt(e)||0n;return[...n,r|t]}),ct=(e,t)=>e.slice(e.length-Math.max(0,t),e.length),lt=e=>e.length<=1?e:Array.from(new Set(e)),ut=(e,t)=>e.includes(t)?e.filter(e=>e!==t):e,dt=()=>!0,_=1n<<0n,v=1n<<1n,y=1n<<2n,b=1n<<3n,ft=1n<<2n,pt=1n<<3n,x=1n<<4n,S=1n<<5n,mt=1n<<6n,ht=1n<<7n,gt=1n<<8n,_t=1n<<9n,vt=1n<<10n,yt=1n<<11n,bt=1n<<12n,C=1n<<13n,xt=1n<<14n,St=1n<<15n,Ct=1n<<16n,wt=1n<<17n,Tt=1n<<18n,Et=1n<<19n,Dt=1n<<20n,Ot=1n<<21n,kt=1n<<22n,At=1n<<23n,jt=1n<<24n,Mt=1n<<25n,w=1n<<26n,T=1n<<27n,E=1n<<28n,D=1n<<29n,O=1n<<30n,k=1n<<31n,A=1n<<32n,j=1n<<33n,M=1n<<34n,N=1n<<35n,P=1n<<36n,F=1n<<37n,I=1n<<38n,L=1n<<39n,R=1n<<40n,z=1n<<41n,B=1n<<42n,V=1n<<43n,H=1n<<44n,U=1n<<45n,W=1n<<46n,G=1n<<47n,K=1n<<48n,q=1n<<49n,Nt=1n<<50n,Pt=1n<<51n,Ft=1n<<52n,It=1n<<53n,Lt=1n<<54n,Rt=1n<<55n,zt=1n<<56n,Bt=1n<<57n,Vt=1n<<58n,Ht=1n<<59n,Ut=1n<<60n,Wt=1n<<61n,Gt=1n<<62n,Kt=1n<<63n,qt=1n<<64n,Jt=1n<<65n,Yt=1n<<66n,Xt=1n<<67n,Zt=1n<<68n,Qt=1n<<69n,$t=1n<<70n,en=1n<<71n,tn=1n<<72n,nn=1n<<73n,rn=1n<<74n,an=1n<<75n,on=1n<<76n,sn=1n<<77n,cn=1n<<78n,ln=1n<<79n,un=1n<<80n,dn=1n<<81n,fn=1n<<82n,pn=1n<<83n,mn=1n<<84n,hn=1n<<85n,gn=1n<<86n,_n=1n<<87n,vn=1n<<88n,yn=1n<<89n,bn=1n<<90n,xn=1n<<91n,Sn=1n<<92n,Cn=1n<<93n,wn=1n<<94n,Tn=1n<<95n,En=1n<<96n,Dn=1n<<97n,On=1n<<98n,kn=1n<<99n,An=1n<<100n,jn=1n<<101n,Mn=1n<<102n,Nn=1n<<103n,Pn=1n<<104n,Fn=1n<<105n,In=1n<<106n,Ln=1n<<107n,Rn=1n<<108n,zn=1n<<109n,Bn=1n<<110n,Vn=1n<<111n,Hn=1n<<112n,Un=1n<<113n,Wn=1n<<114n,Gn=1n<<115n,Kn=1n<<116n,qn=1n<<117n,Jn=1n<<118n,Yn=1n<<119n,Xn=1n<<120n,Zn=1n<<121n,Qn=1n<<122n,$n=1n<<123n,er=1n<<124n,tr=1n<<125n,nr=1n<<126n,rr=1n<<127n,ir=1n<<128n,ar=1n<<129n,or=1n<<130n,sr=1n<<131n,cr=1n<<132n,lr=1n<<133n,ur=1n<<134n,dr=1n<<135n,fr=1n<<136n,pr=1n<<137n,mr=1n<<138n,hr=1n<<139n,gr=1n<<140n,_r=1n<<141n,vr=1n<<142n,yr=1n<<143n,J=1n<<144n,Y=1n<<145n,X=1n<<146n,br=1n<<147n,xr=1n<<148n,Sr=1n<<149n,Cr=1n<<150n,wr=1n<<151n,Tr=1n<<152n,Er=1n<<153n,Dr=1n<<154n,Or=1n<<155n,Z={ControlLeft:_,ControlRight:v,MetaLeft:y,MetaRight:b,OSLeft:ft,OSRight:pt,AltLeft:x,AltRight:S,ShiftLeft:mt,ShiftRight:ht,F1:Pt,F2:Ft,F3:It,F4:Lt,F5:Rt,F6:zt,F7:Bt,F8:Vt,F9:Ht,F10:Ut,F11:Wt,F12:Gt,F13:Kt,F14:qt,F15:Jt,F16:Yt,F17:Xt,F18:Zt,F19:Qt,F20:$t,F21:en,F22:tn,F23:nn,F24:rn,Numpad0:an,Numpad1:on,Numpad2:sn,Numpad3:cn,Numpad4:ln,Numpad5:un,Numpad6:dn,Numpad7:fn,Numpad8:pn,Numpad9:mn,NumpadAdd:hn,NumpadComma:gn,NumpadDecimal:_n,NumpadDivide:vn,NumpadEnter:yn,NumpadEqual:bn,NumpadMultiply:xn,NumpadSubtract:Sn,ArrowDown:Cn,ArrowLeft:wn,ArrowRight:Tn,ArrowUp:En,Backspace:Dn,CapsLock:On,Delete:kn,End:An,Enter:jn,Escape:Mn,Home:Nn,Insert:Pn,PageDown:Fn,PageUp:In,Space:Ln,Tab:Rn,NumLock:Zn,ScrollLock:Qn},kr={Backquote:zn,Backslash:Bn,BracketLeft:Vn,BracketRight:Hn,Comma:Un,Equal:Wn,IntlBackslash:Gn,Minus:Kn,Period:qn,Quote:Jn,Semicolon:Yn,Slash:Xn},Ar={[_]:`ControlLeft`,[v]:`ControlRight`,[y]:`CommandLeft`,[b]:`CommandRight`,[ft]:`CommandLeft`,[pt]:`CommandRight`,[x]:`AltLeft`,[S]:`AltRight`,[mt]:`ShiftLeft`,[ht]:`ShiftRight`,[gt]:`Control`,[_t]:`Command`,[vt]:`Alt`,[yt]:`Shift`,[bt]:`CommandOrControl`,[C]:`CommandOrControlLeft`,[xt]:`CommandOrControlRight`,[St]:`0`,[Ct]:`1`,[wt]:`2`,[Tt]:`3`,[Et]:`4`,[Dt]:`5`,[Ot]:`6`,[kt]:`7`,[At]:`8`,[jt]:`9`,[Mt]:`A`,[w]:`B`,[T]:`C`,[E]:`D`,[D]:`E`,[O]:`F`,[k]:`G`,[A]:`H`,[j]:`I`,[M]:`J`,[N]:`K`,[P]:`L`,[F]:`M`,[I]:`N`,[L]:`O`,[R]:`P`,[z]:`Q`,[B]:`R`,[V]:`S`,[H]:`T`,[U]:`U`,[W]:`V`,[G]:`W`,[K]:`X`,[q]:`Y`,[Nt]:`Z`,[Pt]:`F1`,[Ft]:`F2`,[It]:`F3`,[Lt]:`F4`,[Rt]:`F5`,[zt]:`F6`,[Bt]:`F7`,[Vt]:`F8`,[Ht]:`F9`,[Ut]:`F10`,[Wt]:`F11`,[Gt]:`F12`,[Kt]:`F13`,[qt]:`F14`,[Jt]:`F15`,[Yt]:`F16`,[Xt]:`F17`,[Zt]:`F18`,[Qt]:`F19`,[$t]:`F20`,[en]:`F21`,[tn]:`F22`,[nn]:`F23`,[rn]:`F24`,[an]:`Numpad0`,[on]:`Numpad1`,[sn]:`Numpad2`,[cn]:`Numpad3`,[ln]:`Numpad4`,[un]:`Numpad5`,[dn]:`Numpad6`,[fn]:`Numpad7`,[pn]:`Numpad8`,[mn]:`Numpad9`,[hn]:`NumpadAdd`,[gn]:`NumpadComma`,[_n]:`NumpadDecimal`,[vn]:`NumpadDivide`,[yn]:`NumpadEnter`,[bn]:`NumpadEqual`,[xn]:`NumpadMultiply`,[Sn]:`NumpadSubtract`,[Cn]:`Down`,[wn]:`Left`,[Tn]:`Right`,[En]:`Up`,[Dn]:`Backspace`,[On]:`CapsLock`,[kn]:`Delete`,[An]:`End`,[jn]:`Enter`,[Mn]:`Esc`,[Nn]:`Home`,[Pn]:`Insert`,[Fn]:`PageDown`,[In]:`PageUp`,[Ln]:`Space`,[Rn]:`Tab`,[zn]:"`",[Bn]:`\\`,[Vn]:`[`,[Hn]:`]`,[Un]:`,`,[Wn]:`=`,[Kn]:`-`,[qn]:`.`,[Jn]:`'`,[Yn]:`;`,[Xn]:`/`,[Zn]:`NumLock`,[Qn]:`ScrollLock`,[$n]:`&`,[er]:`*`,[tr]:`@`,[nr]:`{`,[rr]:`}`,[ir]:`^`,[ar]:`:`,[or]:`$`,[sr]:`"`,[cr]:`!`,[lr]:`>`,[ur]:`#`,[dr]:`<`,[fr]:`(`,[pr]:`)`,[mr]:`%`,[hr]:`|`,[gr]:`+`,[_r]:`?`,[vr]:`~`,[yr]:`_`,[J]:`LeftClick`,[Y]:`MiddleClick`,[X]:`RightClick`,[br]:`Mouse3`,[xr]:`Mouse4`,[Sr]:`Mouse5`,[Cr]:`Mouse6`,[wr]:`Mouse7`,[Tr]:`Mouse8`,[Er]:`Mouse9`,[Dr]:`§`,[Or]:`±`},jr={[_]:`Ctrl`,[v]:`Ctrl`,[y]:`Cmd`,[b]:`Cmd`,[ft]:`Cmd`,[pt]:`Cmd`,[x]:`Alt`,[S]:`Alt`,[mt]:`Shift`,[ht]:`Shift`,[gt]:`Ctrl`,[_t]:`Cmd`,[vt]:`Alt`,[yt]:`Shift`,[bt]:`CmdOrCtrl`,[C]:`CmdOrCtrl`,[xt]:`CmdOrCtrl`,[St]:`0`,[Ct]:`1`,[wt]:`2`,[Tt]:`3`,[Et]:`4`,[Dt]:`5`,[Ot]:`6`,[kt]:`7`,[At]:`8`,[jt]:`9`,[Mt]:`A`,[w]:`B`,[T]:`C`,[E]:`D`,[D]:`E`,[O]:`F`,[k]:`G`,[A]:`H`,[j]:`I`,[M]:`J`,[N]:`K`,[P]:`L`,[F]:`M`,[I]:`N`,[L]:`O`,[R]:`P`,[z]:`Q`,[B]:`R`,[V]:`S`,[H]:`T`,[U]:`U`,[W]:`V`,[G]:`W`,[K]:`X`,[q]:`Y`,[Nt]:`Z`,[Pt]:`F1`,[Ft]:`F2`,[It]:`F3`,[Lt]:`F4`,[Rt]:`F5`,[zt]:`F6`,[Bt]:`F7`,[Vt]:`F8`,[Ht]:`F9`,[Ut]:`F10`,[Wt]:`F11`,[Gt]:`F12`,[Kt]:`F13`,[qt]:`F14`,[Jt]:`F15`,[Yt]:`F16`,[Xt]:`F17`,[Zt]:`F18`,[Qt]:`F19`,[$t]:`F20`,[en]:`F21`,[tn]:`F22`,[nn]:`F23`,[rn]:`F24`,[an]:`Num0`,[on]:`Num1`,[sn]:`Num2`,[cn]:`Num3`,[ln]:`Num4`,[un]:`Num5`,[dn]:`Num6`,[fn]:`Num7`,[pn]:`Num8`,[mn]:`Num9`,[hn]:`NumAdd`,[gn]:`§`,[_n]:`NumDec`,[vn]:`NumDiv`,[yn]:`§`,[bn]:`§`,[xn]:`NumMult`,[Sn]:`NumSub`,[Cn]:`Down`,[wn]:`Left`,[Tn]:`Right`,[En]:`Up`,[Dn]:`Backspace`,[On]:`CapsLock`,[kn]:`Delete`,[An]:`End`,[jn]:`Enter`,[Mn]:`Esc`,[Nn]:`Home`,[Pn]:`Insert`,[Fn]:`PageDown`,[In]:`PageUp`,[Ln]:`Space`,[Rn]:`Tab`,[zn]:"`",[Bn]:`\\`,[Vn]:`[`,[Hn]:`]`,[Un]:`,`,[Wn]:`=`,[Kn]:`-`,[qn]:`.`,[Jn]:`'`,[Yn]:`;`,[Xn]:`/`,[Zn]:`NumLock`,[Qn]:`ScrollLock`,[$n]:`&`,[er]:`*`,[tr]:`@`,[nr]:`{`,[rr]:`}`,[ir]:`^`,[ar]:`:`,[or]:`$`,[sr]:`"`,[cr]:`!`,[lr]:`>`,[ur]:`#`,[dr]:`<`,[fr]:`(`,[pr]:`)`,[mr]:`%`,[hr]:`|`,[gr]:`+`,[_r]:`?`,[vr]:`~`,[yr]:`_`,[J]:`§`,[Y]:`§`,[X]:`§`,[br]:`§`,[xr]:`§`,[Sr]:`§`,[Cr]:`§`,[wr]:`§`,[Tr]:`§`,[Er]:`§`,[Dr]:`§`,[Or]:`±`},Mr={[_]:`⌃`,[v]:`⌃`,[y]:`⌘`,[b]:`⌘`,[ft]:`⌘`,[pt]:`⌘`,[x]:`⌥`,[S]:`⌥`,[mt]:`⇧`,[ht]:`⇧`,[gt]:`⌃`,[_t]:`⌘`,[vt]:`⌥`,[yt]:`⇧`,[bt]:g()?`⌘`:`⌃`,[C]:g()?`⌘`:`⌃`,[xt]:g()?`⌘`:`⌃`,[St]:`0`,[Ct]:`1`,[wt]:`2`,[Tt]:`3`,[Et]:`4`,[Dt]:`5`,[Ot]:`6`,[kt]:`7`,[At]:`8`,[jt]:`9`,[Mt]:`A`,[w]:`B`,[T]:`C`,[E]:`D`,[D]:`E`,[O]:`F`,[k]:`G`,[A]:`H`,[j]:`I`,[M]:`J`,[N]:`K`,[P]:`L`,[F]:`M`,[I]:`N`,[L]:`O`,[R]:`P`,[z]:`Q`,[B]:`R`,[V]:`S`,[H]:`T`,[U]:`U`,[W]:`V`,[G]:`W`,[K]:`X`,[q]:`Y`,[Nt]:`Z`,[Pt]:`F1`,[Ft]:`F2`,[It]:`F3`,[Lt]:`F4`,[Rt]:`F5`,[zt]:`F6`,[Bt]:`F7`,[Vt]:`F8`,[Ht]:`F9`,[Ut]:`F10`,[Wt]:`F11`,[Gt]:`F12`,[Kt]:`F13`,[qt]:`F14`,[Jt]:`F15`,[Yt]:`F16`,[Xt]:`F17`,[Zt]:`F18`,[Qt]:`F19`,[$t]:`F20`,[en]:`F21`,[tn]:`F22`,[nn]:`F23`,[rn]:`F24`,[an]:`Numpad0`,[on]:`Numpad1`,[sn]:`Numpad2`,[cn]:`Numpad3`,[ln]:`Numpad4`,[un]:`Numpad5`,[dn]:`Numpad6`,[fn]:`Numpad7`,[pn]:`Numpad8`,[mn]:`Numpad9`,[hn]:`NumpadAdd`,[gn]:`NumpadComma`,[_n]:`NumpadDecimal`,[vn]:`NumpadDivide`,[yn]:`NumpadEnter`,[bn]:`NumpadEqual`,[xn]:`NumpadMultiply`,[Sn]:`NumpadSubtract`,[Cn]:`↓`,[wn]:`←`,[Tn]:`→`,[En]:`↑`,[Dn]:`⌫`,[On]:`⇪`,[kn]:`⌦`,[An]:`↘`,[jn]:`⏎`,[Mn]:`⎋`,[Nn]:`↖`,[Pn]:`⎀`,[Fn]:`⇟`,[In]:`⇞`,[Ln]:`␣`,[Rn]:`⇥`,[zn]:"`",[Bn]:`\\`,[Vn]:`[`,[Hn]:`]`,[Un]:`,`,[Wn]:`=`,[Kn]:`-`,[qn]:`.`,[Jn]:`'`,[Yn]:`;`,[Xn]:`/`,[Zn]:`NumLock`,[Qn]:`ScrollLock`,[$n]:`&`,[er]:`*`,[tr]:`@`,[nr]:`{`,[rr]:`}`,[ir]:`^`,[ar]:`:`,[or]:`$`,[sr]:`"`,[cr]:`!`,[lr]:`>`,[ur]:`#`,[dr]:`<`,[fr]:`(`,[pr]:`)`,[mr]:`%`,[hr]:`|`,[gr]:`+`,[_r]:`?`,[vr]:`~`,[yr]:`_`,[J]:`LeftClick`,[Y]:`MiddleClick`,[X]:`RightClick`,[br]:`Mouse3`,[xr]:`Mouse4`,[Sr]:`Mouse5`,[Cr]:`Mouse6`,[wr]:`Mouse7`,[Tr]:`Mouse8`,[Er]:`Mouse9`,[Dr]:`§`,[Or]:`±`},Nr={0:St,1:Ct,2:wt,3:Tt,4:Et,5:Dt,6:Ot,7:kt,8:At,9:jt},Pr={A:Mt,B:w,C:T,D:E,E:D,F:O,G:k,H:A,I:j,J:M,K:N,L:P,M:F,N:I,O:L,P:R,Q:z,R:B,S:V,T:H,U,V:W,W:G,X:K,Y:q,Z:Nt,a:Mt,b:w,c:T,d:E,e:D,f:O,g:k,h:A,i:j,j:M,k:N,l:P,m:F,n:I,o:L,p:R,q:z,r:B,s:V,t:H,u:U,v:W,w:G,x:K,y:q,z:Nt},Fr={"`":zn,"\\":Bn,"[":Vn,"]":Hn,",":Un,"=":Wn,"-":Kn,".":qn,"'":Jn,";":Yn,"/":Xn,"&":$n,"*":er,"@":tr,"{":nr,"}":rr,"^":ir,":":ar,$:or,'"':sr,"!":cr,">":lr,"#":ur,"<":dr,"(":fr,")":pr,"%":mr,"|":hr,"+":gr,"?":_r,"~":vr,_:yr},Ir={"§":Dr,"±":Or},Lr={...Nr,...Pr,...Fr,...Ir},Rr={0:J,1:Y,2:X,3:br,4:xr,5:Sr,6:Cr,7:wr,8:Tr,9:Er},zr={altleft:x,altright:S,alt:[x,S],optionleft:x,optionright:S,option:[x,S],cmdleft:y,cmdright:b,cmd:[y,b],commandleft:y,commandright:b,command:[y,b],metaleft:y,metaright:b,meta:[y,b],ctrlleft:_,ctrlright:v,ctrl:[_,v],controlleft:_,controlright:v,control:[_,v],shiftleft:mt,shiftright:ht,shift:[mt,ht],cmdleftorctrlleft:g()?y:_,cmdrightorctrlright:g()?b:v,cmdorctrlleft:g()?y:_,cmdorctrlright:g()?b:v,cmdorctrl:g()?[y,b]:[_,v],commandleftorcontrolleft:g()?y:_,commandrightorcontrolright:g()?b:v,commandorcontrolleft:g()?y:_,commandorcontrolright:g()?b:v,commandorcontrol:g()?[y,b]:[_,v],clickleft:J,clickmiddle:Y,clickright:X,leftclick:J,middleclick:Y,rightclick:X,leftmouse:J,middlemouse:Y,rightmouse:X,mouseleft:J,mousemiddle:Y,mouseright:X,mouse0:J,mouse1:Y,mouse2:X,mouse3:br,mouse4:xr,mouse5:Sr,mouse6:Cr,mouse7:wr,mouse8:Tr,mouse9:Er,backspace:Dn,capslock:On,del:kn,delete:kn,down:Cn,end:An,enter:jn,return:jn,esc:Mn,escape:Mn,home:Nn,insert:Pn,left:wn,pagedown:Fn,pageup:In,right:Tn,space:Ln,spacebar:Ln,tab:Rn,up:En,...Nr,...Pr,...Fr,plus:gr,f1:Pt,f2:Ft,f3:It,f4:Lt,f5:Rt,f6:zt,f7:Bt,f8:Vt,f9:Ht,f10:Ut,f11:Wt,f12:Gt,f13:Kt,f14:qt,f15:Jt,f16:Yt,f17:Xt,f18:Zt,f19:Qt,f20:$t,f21:en,f22:tn,f23:nn,f24:rn,numpad0:an,numpad1:on,numpad2:sn,numpad3:cn,numpad4:ln,numpad5:un,numpad6:dn,numpad7:fn,numpad8:pn,numpad9:mn,numpadadd:hn,numpadcomma:gn,numpaddecimal:_n,numpaddivide:vn,numpadenter:yn,numpadequal:bn,numpadmultiply:xn,numpadsubtract:Sn,numlock:Zn,scrolllock:Qn},Br={...zr,ctrl:gt,control:gt,cmd:_t,command:_t,alt:vt,shift:yt,cmdleftorctrlleft:C,cmdrightorctrlright:xt,cmdorctrlleft:C,cmdorctrlright:xt,cmdorctrl:bt,commandleftorcontrolleft:C,commandrightorcontrolright:xt,commandorcontrolleft:C,commandorcontrolright:xt,commandorcontrol:bt},Vr={48:St,49:Ct,50:wt,51:Tt,52:Et,53:Dt,54:Ot,55:kt,56:At,57:jt,65:Mt,66:w,67:T,68:E,69:D,70:O,71:k,72:A,73:j,74:M,75:N,76:P,77:F,78:I,79:L,80:R,81:z,82:B,83:V,84:H,85:U,86:W,87:G,88:K,89:q,90:Nt,97:Mt,98:w,99:T,100:E,101:D,102:O,103:k,104:A,105:j,106:M,107:N,108:P,109:F,110:I,111:L,112:R,113:z,114:B,115:V,116:H,117:U,118:W,119:G,120:K,121:q,122:Nt,96:zn,92:Bn,91:Vn,93:Hn,44:Un,61:Wn,45:Kn,46:qn,39:Jn,59:Yn,47:Xn,38:$n,42:er,64:tr,123:nr,125:rr,94:ir,58:ar,36:or,34:sr,33:cr,62:lr,35:ur,60:dr,40:fr,41:pr,37:mr,124:hr,43:gr,63:_r,126:vr,95:yr},Q=(e,t)=>!!(e&t),Hr=e=>e&Ve,Ur=it(e=>e.trim().replace(We,`+Plus`).replace(Ue,`$1 `).toLowerCase().split(Ge).filter(Boolean)),Wr=it(e=>Xe(e.trim().split(Ge).map(Kr))),Gr=it(e=>e.trim().split(Ge).map(Ur).map(e=>e.map(e=>Br[e]||He))),Kr=it(e=>Xe(Ur(e).map(e=>zr[e]||He)).map(ot)),qr=e=>{if($e(e)){let t=Z[e.code]||0n;return t?[t]:[Lr[e.key]||0n,Vr[e.which]||0n,Ir[e.key]?0n:kr[e.code]||0n]}else if(et(e))return[Rr[e.button]||0n];else return[0n]},Jr=class e{constructor(t={}){this.tree={children:{},handlers:{parent:void 0,prev:void 0,next:void 0,handler:at}},this.treeKonami={children:{},handlers:{parent:void 0,prev:void 0,next:void 0,handler:at}},this.onBlur=()=>{let e=this.chords.length-1,t=this.chordsKonami.length-1;this.chords[e]=0n,this.chordsKonami[t]=0n},this.onNormalize=e=>{if(!$e(e)&&!et(e))return;let{altKey:t,ctrlKey:n,metaKey:r,shiftKey:i}=e,a=$e(e)?e.code:``,o=this.chords.length-1,s=this.chordsKonami.length-1,c=this.chords[o],l=0n,u=Q(c,Z.AltLeft)||Q(c,Z.AltRight),ee=Q(c,Z.ControlLeft)||Q(c,Z.ControlRight),d=Q(c,Z.MetaLeft)||Q(c,Z.MetaRight),te=Q(c,Z.ShiftLeft)||Q(c,Z.ShiftRight),f=a===`AltLeft`||a===`AltRight`,ne=a===`ControlLeft`||a===`ControlRight`,p=a===`MetaLeft`||a===`MetaRight`||a===`OSLeft`||a===`OSRight`,re=a===`ShiftLeft`||a===`ShiftRight`;t&&!u&&!f&&(l|=Z.AltLeft),n&&!ee&&!ne&&(l|=Z.ControlLeft),r&&!d&&!p&&(l|=Z.MetaLeft),i&&!te&&!re&&(l|=Z.ShiftLeft),l&&(this.chords[o]|=l,this.chordsKonami[s]|=l);let m=0n;t||(m|=Z.AltLeft|Z.AltRight),n||(m|=Z.ControlLeft|Z.ControlRight),r||(m|=Z.MetaLeft|Z.MetaRight),i||(m|=Z.ShiftLeft|Z.ShiftRight),m&&(this.chords[o]&=~m,this.chordsKonami[s]&=~m)},this.onRecord=t=>{if(!this.recorder)return;let n=Ze(st(this.chords,t).reverse().map(t=>e.format(t,ze)));n&&this.recorder(n)},this.onDown=e=>{if(!this.shouldHandle(e))return;this.onNormalize(e);let t=this.chords.length-1,n=this.chordsKonami.length-1,r=this.chords[t],i=this.chordsKonami[n],a=r&Be,o=i&Be,s=r===a?[[r,i]]:[[r,i],[a,o]],c=ut(lt(qr(e)),0n);this.onRecord(c);for(let r=0,i=c.length;r<i;r++){let a=c[r],o=r===i-1;for(let r=0,i=s.length;r<i;r++){let[c,l]=s[r],u=r===i-1;this.chords[t]=c|a,this.chordsKonami[n]=l|a;let ee=!this.recorder&&Ke(()=>this.trigger(this.chords,e),!1),d=!!Hr(this.chords[t]);if(ee||o&&u){ee?((!d||et(e)||c&Z.MetaLeft||c&Z.MetaRight)&&(this.chords=d?[this.chords[t]&~a]:[0n]),e.preventDefault(),e.stopImmediatePropagation()):d&&this.chords.push(this.chords[t]&~a),d&&this.chordsKonami.push(this.chordsKonami[n]&~a),this.recorder?(this.chords.length>this.depthRecorder&&(this.chords=ct(this.chords,Math.max(1,this.depthRecorder))),this.chordsKonami=[0n]):(this.chords.length>this.depth&&(this.chords=ct(this.chords,Math.max(1,this.depth))),this.chordsKonami.length>this.depthKonami&&(this.chordsKonami=ct(this.chordsKonami,Math.max(1,this.depthKonami))));break}}}},this.onUp=e=>{if(!this.shouldHandle(e))return;let t=this.chords.length-1,n=this.chordsKonami.length-1,r=ot(qr(e));this.chords[t]&=~r,this.chordsKonami[n]&=~r},this.record=e=>{let t=this.active;return this.chords=[0n],this.chordsKonami=[0n],this.recorder=e,t||this.start(),()=>{this.chords=[0n],this.chordsKonami=[0n],this.recorder=void 0,t||this.stop()}},this.register=(e,t,n={})=>{var r,i;let a=qe(e).map(Wr),o=[],s=!!n.konami;for(let e of a)for(let n of e){let e=s?this.treeKonami:this.tree,a=0;for(let t of n)e=(r=e.children)[i=String(t)]||(r[i]={children:{},handlers:{parent:void 0,prev:void 0,next:void 0,handler:at}}),a+=1;s?this.depthKonami=Math.max(this.depthKonami,a):this.depth=Math.max(this.depth,a);let c=e.handlers;e.handlers=c.next={parent:e,prev:c,next:void 0,handler:t},o.push(e.handlers)}return()=>{for(let e of o){let{prev:t,next:n}=e;t&&(t.next=n),n&&(n.prev=t),!n&&e.parent&&(e.parent.handlers=t)}}},this.reset=()=>{this.tree.children={},this.treeKonami.children={}},this.trigger=(e,t)=>{let n=tt(e)?Ze(Wr(e)):qe(e),r=this.chordsKonami;if(!n)return!1;if(this.depthKonami)for(let e=0,n=r.length;e<n;e++){let n=e?r.slice(e):r,i=this.treeKonami;for(let e of n)i=i?.children[String(e)];let a=i?.handlers;for(;a;)a.handler(t),a=a.prev}if(this.depth)for(let e=0,r=n.length;e<r;e++){let r=e?n.slice(e):n,i=this.tree;for(let e of r)i=i?.children[String(e)];let a=i?.handlers;for(;a;)if(a.handler(t)!==!0)a=a.prev;else return!0}return!1},this.start=()=>{if(this.active)return;this.active=!0;let e=this.options.capture??!1,t=this.options.target||document;t.addEventListener(`keydown`,this.onDown,{capture:e}),t.addEventListener(`keyup`,this.onUp,{capture:e}),t.addEventListener(`click`,this.onDown,{capture:e}),t.addEventListener(`auxclick`,this.onDown,{capture:e}),t.addEventListener(`contextmenu`,this.onDown,{capture:e}),window.addEventListener(`blur`,this.onBlur)},this.stop=()=>{if(!this.active)return;this.active=!1;let e=this.options.capture??!1,t=this.options.target||document;t.removeEventListener(`keydown`,this.onDown,{capture:e}),t.removeEventListener(`keyup`,this.onUp,{capture:e}),t.removeEventListener(`click`,this.onDown,{capture:e}),t.removeEventListener(`auxclick`,this.onDown,{capture:e}),t.removeEventListener(`contextmenu`,this.onDown,{capture:e}),window.removeEventListener(`blur`,this.onBlur)},this.active=!1,this.chords=[0n],this.chordsKonami=[0n],this.depth=0,this.depthKonami=0,this.depthRecorder=0,this.shouldHandle=t.shouldHandleEvent||dt,this.options=t}};Jr.format=(e,t=Re)=>{let n=t===`electron`?jr:t===`symbols`?Mr:Ar,r=t===`symbols`?``:`+`,i=(tt(e)?Gr(e):qe(e).map(e=>e===He?[]:Ye(e))).map(e=>e.sort(Je).map(e=>n[e]||`§`).join(r)).join(` `);if(t.includes(`-nondirectional`)&&(i=i.replace(/(CommandOrControl|Control|Command|Alt|Shift)Left(\S+)\1Right/g,`$1§eft$2$1§ight`),i=i.replace(/(CommandOrControl|Control|Command|Alt|Shift)Right(\S+)\1Left/g,`$1§ight$2$1§eft`),i=i.replace(/(Control|Command|Alt|Shift)(Left|Right)/g,`$1`),i=i.replaceAll(`§eft`,`Left`),i=i.replaceAll(`§ight`,`Right`)),t.includes(`-inflexible`)){let e=g()?`Command`:`Control`;i=i.replace(/Command(Left|Right)?OrControl/g,e)}return t.includes(`-flexible`)&&(i=i.replace(/Control(\S+)Command/g,`§ontrol$1§ommand`),i=i.replace(/Command(\S+)Control/g,`§ommand$1§ontrol`),i=i.replace(/(^|\W)Control/g,`$1CommandOrControl`),i=i.replace(/Command(?!Or|Left|Right)/g,`CommandOrControl`),i=i.replace(/CommandLeft(?!Or)/g,`CommandOrControlLeft`),i=i.replace(/CommandRight(?!Or)/g,`CommandOrControlRight`),i=i.replaceAll(`§ontrol`,`Control`),i=i.replaceAll(`§ommand`,`Command`)),t.includes(`short-`)&&(i=i.replaceAll(`Command`,`Cmd`),i=i.replaceAll(`Control`,`Ctrl`)),i},Jr.isShortcut=it(e=>Ur(e).every(e=>e in zr)),Jr.record=(e,t={})=>{let n=t.shouldHandleEvent||dt,r=new Jr({capture:!0,target:window,shouldHandleEvent:e=>n(e)?(t.passthrough||(e.preventDefault(),e.stopImmediatePropagation()),!0):!1});return r.depthRecorder=t.limit??10,r.record(e)};var Yr=Jr,Xr=class{bindings=[];commandRegistry;shosho;disposers=new Map;constructor(e){this.commandRegistry=e,this.initializeShoSho(document)}initializeShoSho(e){this.shosho&&(this.shosho.stop(),this.shosho.reset()),this.shosho=new Yr({capture:!0,target:e,shouldHandleEvent(e){let t=e.target;return!(t.tagName===`INPUT`||t.tagName===`TEXTAREA`||t.isContentEditable)}}),this.disposers.clear();for(let e of this.bindings)this.registerWithShoSho(e)}registerWithShoSho(e){let t=this.shosho.register(e.shortcut,()=>(this.commandRegistry.execute(e.commandId),!0));this.disposers.has(e.commandId)||this.disposers.set(e.commandId,[]),this.disposers.get(e.commandId).push(t)}register(e){this.bindings.push(e),this.shosho&&this.registerWithShoSho(e)}registerMany(e){for(let t of e)this.register(t)}unregister(e){this.bindings=this.bindings.filter(t=>t.commandId!==e);let t=this.disposers.get(e);t&&(t.forEach(e=>e()),this.disposers.delete(e))}activate(e=document){e!==document&&this.initializeShoSho(e),this.shosho.start()}deactivate(e=document){this.shosho&&this.shosho.stop()}getBindings(){return[...this.bindings]}getShortcutsForCommand(e){return this.bindings.filter(t=>t.commandId===e).map(e=>e.shortcut)}static formatShortcut(e){return Yr.format(e)}},$=class extends Error{constructor(e){super(e),this.name=`ShortcutValidationError`}};function Zr(e){return typeof e==`string`&&e.trim().length>0}function Qr(e,t,n){if(!Zr(e))throw new $(`Shortcut at index ${n} has invalid '${t}' field (must be a non-empty string)`);return e.trim()}function $r(e,t){if(!e||typeof e!=`object`)throw new $(`Shortcut at index ${t} is not an object`);let n=e;if(!(`shortcut`in n))throw new $(`Shortcut at index ${t} is missing 'shortcut' field`);let r=Qr(n.shortcut,`shortcut`,t);if(!(`commandId`in n))throw new $(`Shortcut at index ${t} is missing 'commandId' field`);let i=Qr(n.commandId,`commandId`,t),a;return`description`in n&&n.description!==void 0&&(a=Qr(n.description,`description`,t)),{shortcut:r,commandId:i,description:a}}function ei(e){if(!e||typeof e!=`object`)throw new $(`Configuration must be an object`);let t=e;if(!(`shortcuts`in t))throw new $(`Configuration is missing "shortcuts" field`);if(!Array.isArray(t.shortcuts))throw new $(`"shortcuts" field must be an array`);let n=[];for(let e=0;e<t.shortcuts.length;e++)n.push($r(t.shortcuts[e],e));return{shortcuts:n}}function ti(e){return e.shortcuts.map(e=>({shortcut:e.shortcut,commandId:e.commandId}))}function ni(e){let t;try{t=JSON.parse(e)}catch(e){throw new $(`Invalid JSON: ${e instanceof Error?e.message:String(e)}`)}return ti(ei(t))}var ri=`{
  "shortcuts": [
    {
      "shortcut": "Ctrl+O",
      "commandId": "file-open",
      "description": "Open file dialog"
    },
    {
      "shortcut": "Ctrl+W",
      "commandId": "file-close",
      "description": "Close current file"
    },
    {
      "shortcut": "Ctrl+Q",
      "commandId": "file-quit",
      "description": "Quit application"
    },
    {
      "shortcut": "Ctrl+Z",
      "commandId": "edit-undo",
      "description": "Undo last action"
    },
    {
      "shortcut": "Ctrl+=",
      "commandId": "view-zoom-in",
      "description": "Zoom in"
    },
    {
      "shortcut": "Ctrl+-",
      "commandId": "view-zoom-out",
      "description": "Zoom out"
    }
  ]
}
`,ii=[];try{ii=ni(ri)}catch(e){console.error(`Failed to load default shortcuts. Falling back to empty shortcuts array. Error:`,e)}var ai=`:host{z-index:10000;pointer-events:none;display:none;position:fixed;inset:0}:host(.open){pointer-events:auto;display:block}.overlay{background-color:#00000080;animation:.15s ease-out fadeIn;position:absolute;inset:0}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.palette{background-color:var(--color-bg-surface,#fff);border:1px solid var(--color-border,#ccc);border-radius:8px;width:90%;max-width:600px;animation:.15s ease-out slideDown;position:absolute;top:20%;left:50%;overflow:hidden;transform:translate(-50%);box-shadow:0 4px 20px #0000004d}@keyframes slideDown{0%{opacity:0;transform:translate(-50%)translateY(-10px)}to{opacity:1;transform:translate(-50%)translateY(0)}}.search-container{border-bottom:1px solid var(--color-border,#ccc);padding:16px}.search-input{width:100%;color:var(--color-text,#0f0f0f);background-color:#0000;border:none;outline:none;padding:12px;font-family:inherit;font-size:16px}.search-input::placeholder{color:var(--color-text-muted,#666)}.results{max-height:400px;overflow-y:auto}.result-item{cursor:pointer;border-bottom:1px solid var(--color-border,#eee);color:var(--color-text,#0f0f0f);background-color:var(--color-bg-surface,#fff);justify-content:space-between;align-items:center;padding:12px 16px;display:flex}.result-item:last-child{border-bottom:none}.result-item:hover,.result-item.selected{background-color:var(--color-bg-hover,#e0e0e0)}.result-item .label{flex:1;font-size:14px}.result-item .id{color:var(--color-text-muted,#666);font-family:monospace;font-size:12px}.empty-state{text-align:center;color:var(--color-text-muted,#666);padding:40px 16px;font-size:14px}`,oi=class extends HTMLElement{commandRegistry;isOpen=!1;searchInput=null;resultsContainer=null;selectedIndex=0;filteredCommands=[];constructor(e){super(),this.commandRegistry=e,this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[ce,m(ai)],this.shadowRoot.innerHTML=`
            <div class="overlay"></div>
            <div class="palette">
                <div class="search-container">
                    <input
                        type="text"
                        class="search-input"
                        placeholder="Type a command..."
                        autocomplete="off"
                        spellcheck="false"
                    />
                </div>
                <div class="results"></div>
            </div>
        `,this.searchInput=this.shadowRoot.querySelector(`.search-input`),this.resultsContainer=this.shadowRoot.querySelector(`.results`),this.setupEventListeners()}setupEventListeners(){this.searchInput?.addEventListener(`input`,()=>{this.handleSearch()}),this.searchInput?.addEventListener(`keydown`,e=>{this.handleKeyDown(e)}),this.shadowRoot.querySelector(`.overlay`)?.addEventListener(`click`,()=>{this.close()}),this.shadowRoot.querySelector(`.palette`)?.addEventListener(`click`,e=>{e.stopPropagation()})}open(){this.isOpen=!0,this.classList.add(`open`),this.selectedIndex=0,this.searchInput&&(this.searchInput.value=``,this.searchInput.focus()),this.handleSearch()}close(){this.isOpen=!1,this.classList.remove(`open`),this.filteredCommands=[],this.searchInput&&(this.searchInput.value=``)}toggle(){this.isOpen?this.close():this.open()}handleSearch(){let e=this.searchInput?.value.toLowerCase()||``,t=this.commandRegistry.getAll();e===``?this.filteredCommands=t:this.filteredCommands=t.filter(t=>{let n=t.label.toLowerCase().includes(e),r=t.id.toLowerCase().includes(e);return n||r}),this.selectedIndex=0,this.render()}handleKeyDown(e){switch(e.key){case`Escape`:e.preventDefault(),this.close();break;case`ArrowDown`:e.preventDefault(),this.selectedIndex=Math.min(this.selectedIndex+1,this.filteredCommands.length-1),this.render();break;case`ArrowUp`:e.preventDefault(),this.selectedIndex=Math.max(this.selectedIndex-1,0),this.render();break;case`Enter`:e.preventDefault(),this.executeSelected();break}}executeSelected(){let e=this.filteredCommands[this.selectedIndex];e&&(this.commandRegistry.execute(e.id),this.close())}render(){if(!this.resultsContainer)return;if(this.filteredCommands.length===0){this.resultsContainer.innerHTML=`
                <div class="empty-state">No commands found</div>
            `;return}this.resultsContainer.innerHTML=``,this.filteredCommands.forEach((e,t)=>{let n=document.createElement(`div`);n.className=`result-item`,t===this.selectedIndex&&n.classList.add(`selected`);let r=document.createElement(`div`);r.className=`label`,r.textContent=e.label;let i=document.createElement(`div`);i.className=`id`,i.textContent=e.id,n.appendChild(r),n.appendChild(i),n.addEventListener(`click`,()=>{this.selectedIndex=t,this.executeSelected()}),n.addEventListener(`mouseenter`,()=>{this.selectedIndex=t,this.render()}),this.resultsContainer.appendChild(n)});let e=this.resultsContainer.querySelector(`.result-item.selected`);e&&typeof e.scrollIntoView==`function`&&e.scrollIntoView({block:`nearest`})}};customElements.get(`command-palette`)||customElements.define(`command-palette`,oi);var si=class{commandRegistry;shortcutManager;commandPalette=null;constructor(){this.commandRegistry=new Le,this.shortcutManager=new Xr(this.commandRegistry)}getCommandRegistry(){return this.commandRegistry}getShortcutManager(){return this.shortcutManager}getCommandPalette(){return this.commandPalette}initializeCommandPalette(){this.commandPalette=new oi(this.commandRegistry),document.body.appendChild(this.commandPalette)}initializeShortcuts(e){this.commandRegistry.register({id:`file-open`,label:`Open File`,handler:e.onFileOpen}),this.commandRegistry.register({id:`file-quit`,label:`Quit`,handler:e.onFileQuit}),this.commandRegistry.register({id:`edit-undo`,label:`Undo`,handler:e.onEditUndo}),this.commandRegistry.register({id:`view-zoom-in`,label:`Zoom In`,handler:e.onZoomIn}),this.commandRegistry.register({id:`view-zoom-out`,label:`Zoom Out`,handler:e.onZoomOut}),this.commandRegistry.register({id:`view-zoom-fit`,label:`Zoom to Fit`,handler:e.onZoomFit}),this.commandRegistry.register({id:`command-palette-toggle`,label:`Open Command Palette`,handler:()=>{this.commandPalette&&this.commandPalette.toggle()}}),this.shortcutManager.registerMany(ii),this.shortcutManager.register({shortcut:`Ctrl+K`,commandId:`command-palette-toggle`}),this.shortcutManager.activate()}deactivate(){this.shortcutManager.deactivate(),this.commandPalette&&this.commandPalette.parentNode&&this.commandPalette.parentNode.removeChild(this.commandPalette)}},ci=class{dockManager;constructor(e){this.dockManager=e}findMainStack(){let e=this.dockManager.layout;if(!e)return null;let t=e.root;if(t.type===`box`){for(let e of t.children)if(e.type===`stack`&&e.id===`main-stack`)return e}return null}findBiggestStack(e){if(e.type===`stack`)return e;if(e.type===`box`){let t=null,n=-1/0;for(let r of e.children){let e=this.findBiggestStack(r);e&&e.weight>n&&(n=e.weight,t=e)}return t}return null}addDockPane(e){let t=this.findMainStack();if(!t)return;let n=e.split(/[/\\]/).pop()||e,r={id:`file-pane-${e}`,title:n,contentId:`file-${e}`,closable:!0};t.children.push(r),t.activeId=r.id,this.dockManager.render()}removeDockPane(e){let t=this.findMainStack();if(!t)return;let n=`file-pane-${e}`;t.children=t.children.filter(e=>e.id!==n),t.activeId===n&&(t.activeId=t.children.length>0?t.children[0].id:null),this.dockManager.render()}updateSidebarVisibility(e){let t=this.dockManager.layout;if(!t||t.root.type!==`box`)return;let n=t.root,r=n.children.findIndex(e=>e.type===`stack`&&e.id===`sidebar-stack`),i=n.children.findIndex(e=>e.type===`stack`&&e.id===`main-stack`);e?r===-1&&i!==-1&&(n.children.unshift({type:`stack`,id:`sidebar-stack`,weight:20,activeId:`signal-selection-pane`,children:[{id:`signal-selection-pane`,title:`Signal Selection`,contentId:`signal-selection`,closable:!1},{id:`settings-pane`,title:`Settings`,contentId:`settings`,closable:!0}]}),this.dockManager.render()):r!==-1&&(n.children.splice(r,1),this.dockManager.render())}setActivePane(e){let t=this.findMainStack();t&&(t.activeId=e,this.dockManager.render())}},li=class{dockManager;layoutHelper;constructor(e,t){this.dockManager=e,this.layoutHelper=t}activatePane(e,t,n,r=!0){let i=this.dockManager.layout;if(!i){console.warn(`No layout available to activate pane`);return}let a=this.layoutHelper.findBiggestStack(i.root);if(!a){console.warn(`Could not find any stack to activate pane`);return}a.children.some(t=>t.id===e)||a.children.push({id:e,title:t,contentId:n,closable:r}),a.activeId=e,this.dockManager.layout=i}closePane(e){let t=this.dockManager.layout;t&&(this.removePaneFromNode(t.root,e),this.dockManager.layout=t)}removePaneFromNode(e,t){if(e.type===`stack`)e.children=e.children.filter(e=>e.id!==t),e.activeId===t&&(e.activeId=e.children.length>0?e.children[0].id:null);else if(e.type===`box`)for(let n of e.children)this.removePaneFromNode(n,t)}},ui=class extends HTMLElement{fileManager;commandManager;dockLayoutHelper;paneManager;dockManager;hierarchyTree;fileViewContainer;settingsPage;aboutPane;constructor(){super(),this.fileManager=new Ie,this.commandManager=new si,this.attachShadow({mode:`open`}),this.shadowRoot.adoptedStyleSheets=[m(Ce)],this.shadowRoot.innerHTML=`
        <app-menu-bar></app-menu-bar>

        <div class="container">
            <div id="workspace">
                <dock-manager id="main-dock"></dock-manager>
            </div>
        </div>
        `,this.dockManager=this.shadowRoot.getElementById(`main-dock`),this.dockLayoutHelper=new ci(this.dockManager),this.paneManager=new li(this.dockManager,this.dockLayoutHelper),this.hierarchyTree=new _e,this.hierarchyTree.id=`hierarchy-tree`,this.settingsPage=new ye,this.settingsPage.id=`settings-panel`,this.fileViewContainer=document.createElement(`div`),this.fileViewContainer.className=`dockable-content`,this.fileViewContainer.innerHTML=`
            <app-tab-bar id="tabs"></app-tab-bar>
            <main id="content-area" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; position: relative;">
                <div id="empty-state" class="empty-state">
                    <h1>Wave View</h1>
                    <div class="row">
                        <button id="file-picker-btn">Open File</button>
                    </div>
                </div>
                <div id="files-container"></div>
            </main>
        `,this.dockManager.registerContent(`signal-selection`,()=>this.hierarchyTree),this.dockManager.registerContent(`file-view`,()=>this.fileViewContainer),this.dockManager.registerContent(`settings`,()=>this.settingsPage),this.dockManager.registerContent(`about`,()=>this.aboutPane),this.dockManager.layout={root:{type:`box`,id:`root-box`,direction:`row`,weight:1,children:[{type:`stack`,id:`sidebar-stack`,weight:20,activeId:`signal-selection-pane`,children:[{id:`signal-selection-pane`,title:`Signal Selection`,contentId:`signal-selection`,closable:!1}]},{type:`stack`,id:`main-stack`,weight:80,activeId:null,children:[]}]}}}async connectedCallback(){await r(),this.initializeShortcuts(),this.commandManager.initializeCommandPalette(),this.initializeAboutPane(),this.addEventListener(`file-open-request`,()=>this.handleFileOpen()),this.addEventListener(`open-example-request`,e=>{let t=e;this.handleOpenExample(t.detail)});let e=this.fileViewContainer.querySelector(`#file-picker-btn`);e&&e.addEventListener(`click`,()=>this.handleFileOpen()),this.addEventListener(`settings-open-request`,()=>{this.activateSettingsPane()}),this.addEventListener(`about-open-request`,()=>{this.activateAboutPane()}),this.addEventListener(`setting-changed`,e=>{let{path:t,value:n}=e.detail;t===`Application/Color Theme`&&u.setTheme(n)}),this.addEventListener(`menu-action`,e=>{let t=e.detail;t&&this.commandManager.getCommandRegistry().has(t)&&this.commandManager.getCommandRegistry().execute(t)}),this.addEventListener(`pane-close`,e=>{let t=e.detail.id;if(t===`settings-pane`){this.paneManager.closePane(`settings-pane`);return}if(t===`about-pane`){this.paneManager.closePane(`about-pane`);return}if(t.startsWith(`file-pane-`)){let e=t.substring(10);this.closeFile(e)}}),this.addEventListener(`pane-select`,e=>{let t=e.detail.id;if(t.startsWith(`file-pane-`)){let e=t.substring(10);this.setActiveFile(e)}}),this.addEventListener(`selected-signals-changed`,e=>{let{filename:t,signalRefs:n}=e.detail;t===this.fileManager.getActiveFileId()&&(this.hierarchyTree.selectedSignalRefs=n)}),await this.refreshFiles()}disconnectedCallback(){this.commandManager.deactivate()}initializeShortcuts(){this.commandManager.initializeShortcuts({onFileOpen:()=>this.handleFileOpen(),onFileQuit:async()=>{let{isTauri:e}=await f(async()=>{let{isTauri:e}=await import(`./backend-DthrPGwh.js`);return{isTauri:e}},__vite__mapDeps([4,5,1]));if(e){let{getCurrentWindow:e}=await f(async()=>{let{getCurrentWindow:e}=await import(`./window-D7BWqsld.js`);return{getCurrentWindow:e}},__vite__mapDeps([3,1,2]));await e().close()}},onEditUndo:()=>{console.log(`Undo action triggered`)},onZoomIn:()=>{this.dispatchZoomCommand(`zoom-in`)},onZoomOut:()=>{this.dispatchZoomCommand(`zoom-out`)},onZoomFit:()=>{this.dispatchZoomCommand(`zoom-fit`)}})}initializeAboutPane(){this.aboutPane=new xe}async refreshFiles(){let{fileIds:e,activeFileId:t}=await this.fileManager.refreshFiles(async e=>{let t=this.fileManager.getFileResources(e)?.element;t&&(this.dockManager.registerContent(`file-${e}`,()=>t),this.dockLayoutHelper.addDockPane(e))},e=>{this.dockLayoutHelper.removeDockPane(e)});t&&this.setActiveFile(t),this.dockLayoutHelper.updateSidebarVisibility(e.length>0)}async handleFileOpen(){let e=await this.fileManager.handleFileOpen();e&&(await this.refreshFiles(),this.setActiveFile(e))}async handleOpenExample(e){let t=await this.fileManager.handleOpenExample(e);t&&(await this.refreshFiles(),this.setActiveFile(t))}setActiveFile(e){if(!this.fileManager.hasFile(e))return;this.fileManager.setActiveFileId(e);let t=this.fileManager.getFileResources(e);if(this.hierarchyTree&&(this.hierarchyTree.filename=e,this.hierarchyTree.data=t?t.hierarchy:null,t)){let e=t.element.getSelectedSignalRefs();this.hierarchyTree.selectedSignalRefs=e}Se(e),this.dockLayoutHelper.setActivePane(`file-pane-${e}`)}async closeFile(e){await this.fileManager.closeFile(e),await this.refreshFiles()}activateSettingsPane(){this.paneManager.activatePane(`settings-pane`,`Settings`,`settings`,!0)}activateAboutPane(){this.paneManager.activatePane(`about-pane`,`About`,`about`,!0)}dispatchZoomCommand(e){let t=this.fileManager.getActiveFileId();if(!t)return;let n=this.fileManager.getFileResources(t);if(!n)return;let r=new CustomEvent(`zoom-command`,{detail:{action:e},bubbles:!1,composed:!1});n.element.dispatchEvent(r)}};customElements.get(`app-main`)||customElements.define(`app-main`,ui);